<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Resample Univariate or Multivariate Dimorphism — resampleSSD • dimorph</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Resample Univariate or Multivariate Dimorphism — resampleSSD"><meta name="description" content="Function to generate a set of resampled dimorphism estimates for a univariate or multivariate sample.
  Called by SSDtest and bootdimorph."><meta property="og:description" content="Function to generate a set of resampled dimorphism estimates for a univariate or multivariate sample.
  Called by SSDtest and bootdimorph."><meta property="og:image" content="https://adamdgordon.github.io/dimorph/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dimorph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dimorph.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Resample Univariate or Multivariate Dimorphism</h1>

      <div class="d-none name"><code>resampleSSD.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Function to generate a set of resampled dimorphism estimates for a univariate or multivariate sample.
  Called by <code><a href="SSDtest.html">SSDtest</a></code> and <code><a href="bootdimorph.html">bootdimorph</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">resampleSSD</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  struc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  compsex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  npersample <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  nResamp <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  exact <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  limit <span class="op">=</span> <span class="fl">5e+05</span>,</span>
<span>  matchvars <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  replace <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  datastruc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  methsMulti <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  methsUni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span>
<span>  sex.female <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  center <span class="op">=</span> <span class="st">"geomean"</span>,</span>
<span>  templatevar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  ncorrection <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  details <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A matrix or data frame of measurements from a comparative sample, with rows
corresponding to individual specimens and columns corresponding to size variables.  Sex data
should not be included.  Should not include <code>NA</code>s; resampling addresses will not be
affected, but these addresses may generate errors when used by other functions.</p></dd>


<dt id="arg-struc">struc<a class="anchor" aria-label="anchor" href="#arg-struc"></a></dt>
<dd><p>Structure information for the data set being compared against, typically from one or
more fossil samples with missing data. <code>struc</code> must be either (1) a matrix or dataframe
of measurements (which can include <code>NA</code>s) or (2) a vector of integer sample sizes for each
variable.</p></dd>


<dt id="arg-compsex">compsex<a class="anchor" aria-label="anchor" href="#arg-compsex"></a></dt>
<dd><p>A vector indicating sex for the individuals in <code>x</code>.  Sex
information is not included in any calculations in this function but will be included
as a list element in the returned object.  Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-npersample">npersample<a class="anchor" aria-label="anchor" href="#arg-npersample"></a></dt>
<dd><p>Integer specifying the sample size of resampled datasets.  Defaults to <code>NA</code>.
If set to <code>NA</code>, the sample size of resampled datasets is set equal to the sample size of
<code>x</code>.</p></dd>


<dt id="arg-nresamp">nResamp<a class="anchor" aria-label="anchor" href="#arg-nresamp"></a></dt>
<dd><p>Integer specifying the number of resampling iterations to calculate addresses
for if Monte Carlo sampling is used.</p></dd>


<dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p>Logical scalar specifying whether to sample all unique combinations of sample
size <code>npersample</code> from <code>x</code>.  Defaults to <code>FALSE</code>.  If set to <code>FALSE</code>, or if set
to <code>TRUE</code> and the number of unique combinations exceeds <code>limit</code>, then Monte Carlo sampling
is used instead.</p></dd>


<dt id="arg-limit">limit<a class="anchor" aria-label="anchor" href="#arg-limit"></a></dt>
<dd><p>Integer setting the upper limit on the number of unique combinations allowable
for exact resampling.  If exact resampling would produce more resampled datasets than this number,
Monte Carlo resampling is used instead.  Defaults to 500,000.</p></dd>


<dt id="arg-matchvars">matchvars<a class="anchor" aria-label="anchor" href="#arg-matchvars"></a></dt>
<dd><p>Logical scalar specifying whether to compare the variable names in
<code>comparative</code> and <code>struc</code> and pare them both down to the set of shared variables.
If <code>FALSE</code>  and variable names differ then an error will be returned.  Defaults to
<code>FALSE</code>.</p></dd>


<dt id="arg-replace">replace<a class="anchor" aria-label="anchor" href="#arg-replace"></a></dt>
<dd><p>Logical scalar passed to <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></code> specifying whether or not
to sample with replacement.  Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-datastruc">datastruc<a class="anchor" aria-label="anchor" href="#arg-datastruc"></a></dt>
<dd><p>If multivariate data are used, this is a character string specifiying whether to
incorporate the missing data structure
into dimorphism estimates (<code>"missing"</code>), whether to downsample to the missing data sample size but
keep all metric data for the comparative sample (<code>"complete"</code>), or to perform both types of
resampling separately (<code>"both"</code>).  Defaults to <code>"missing"</code>, and ignored if only univariate
data are provided.</p></dd>


<dt id="arg-methsmulti">methsMulti<a class="anchor" aria-label="anchor" href="#arg-methsmulti"></a></dt>
<dd><p>A character string specifying the multivariate method used to
calculate or estimate dimorphism.  Note that regardless of the value of this argument,
multivariate estimation procedures will only be carried out if <code>x</code> is a multivariate
dataset.  See <code><a href="dimorph.html">dimorph</a></code> for options.</p></dd>


<dt id="arg-methsuni">methsUni<a class="anchor" aria-label="anchor" href="#arg-methsuni"></a></dt>
<dd><p>A character string specifying the univariate method used to calculate or estimate dimorphism.
See <code><a href="dimorph.html">dimorph</a></code> for options.</p></dd>


<dt id="arg-sex-female">sex.female<a class="anchor" aria-label="anchor" href="#arg-sex-female"></a></dt>
<dd><p>An integer scalar (1 or 2) specifying which level of <code>sex</code>
corresponds to female.  Ignored if <code>sex</code> is <code>NULL</code>.  Defaults to 1.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>A character string specifying the method used to calculate a mean, either <code>"geomean"</code>
(default) which uses the geometric mean, or <code>"mean"</code> which uses the arithmetic mean.  More broadly,
<code>"geomean"</code> indicates analyses are conducted in logarithmic data space and <code>"mean"</code> indicates
analyses are conducted in raw data space.  Some methods can only be applied in one domain or the other:
<code>"CV"</code> and <code>"CVsex"</code> are always calculated in raw data space and <code>center</code> will be set to
<code>"mean"</code> for these methods regardless of the value set by the user; <code>"MoM"</code>, <code>"sdlog"</code>,
and <code>"sdlogsex"</code> are always calculated in logarithmic data space and <code>center</code> will be set to
<code>"geomean"</code> for these methods regardless of the value set by the user.</p></dd>


<dt id="arg-templatevar">templatevar<a class="anchor" aria-label="anchor" href="#arg-templatevar"></a></dt>
<dd><p>A character object or integer value specifying the name or column number
of the variable in <code>x</code> to be estimated using the template method.  Ignored if template method
is not used.  Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>A logical scalar indicating whether NA values should be stripped before
the computation proceeds.  Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-ncorrection">ncorrection<a class="anchor" aria-label="anchor" href="#arg-ncorrection"></a></dt>
<dd><p>A logical scalar indicating whether to apply Sokal and Braumann's (1980)
size correction factor to CV estimates.  Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-details">details<a class="anchor" aria-label="anchor" href="#arg-details"></a></dt>
<dd><p>A logical scalar indicating whether variable name and specimen names
should be retained (if available) as attributes in the output object.  Defaults to
<code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>dimorphResampledUni</code> or <code>dimorphResampledMulti</code> containing a dataframe
  with resampled dimorphism estimates and a <code>dimorphAds</code> object containg resampled addresses produced
  by <code><a href="getsampleaddresses.html">getsampleaddresses</a></code>.  Plotting this object produces violin plots for
  all resampled distributions.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bootdimorph.html">bootdimorph</a></code>, <code><a href="dimorph.html">dimorph</a></code>, <code><a href="getsampleaddresses.html">getsampleaddresses</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Univariate</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">apelimbart</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gor</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># this is effectively a bootstrap, although see 'bootdimorph'</span></span></span>
<span class="r-in"><span><span class="va">gorSSD</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span><span class="va">gor</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      compsex<span class="op">=</span><span class="va">gor</span><span class="op">$</span><span class="va">Sex</span>, nResamp<span class="op">=</span><span class="fl">100</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSD</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledUni Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable name: FHSI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSD, MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method and centering algorithm: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITH replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSD</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now downsample to fossil sample size and sample without replacement</span></span></span>
<span class="r-in"><span><span class="va">SSDvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HHMaj"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSD1</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span>x<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                       struc<span class="op">=</span><span class="va">fauxil</span><span class="op">[</span><span class="va">fauxil</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Fauxil sp. 1"</span>, <span class="va">SSDvars</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                       compsex<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                       exact<span class="op">=</span><span class="cn">TRUE</span>, matchvars<span class="op">=</span><span class="cn">TRUE</span>, replace<span class="op">=</span><span class="cn">FALSE</span>, methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of possible combinations (54891018) exceeds the user-specified limit. Monte Carlo sampling will be used.</span>
<span class="r-in"><span><span class="va">gorSSD1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledUni Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable name: HHMaj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSD, MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method and centering algorithm: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITHOUT replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSD1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or run 'getsampleaddresses' first</span></span></span>
<span class="r-in"><span><span class="va">addressesUni</span> <span class="op">&lt;-</span> <span class="fu"><a href="getsampleaddresses.html">getsampleaddresses</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     comparative<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     struc<span class="op">=</span><span class="va">fauxil</span><span class="op">[</span><span class="va">fauxil</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Fauxil sp. 1"</span>, <span class="va">SSDvars</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     compsex<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     exact<span class="op">=</span><span class="cn">TRUE</span>, matchvars<span class="op">=</span><span class="cn">TRUE</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The number of possible combinations (54891018) exceeds the user-specified limit. Monte Carlo sampling will be used.</span>
<span class="r-in"><span><span class="va">gorSSD2</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span><span class="va">addressesUni</span>, methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSD2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledUni Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable name: HHMaj</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSD, MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method and centering algorithm: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITHOUT replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSD2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multivariate</span></span></span>
<span class="r-in"><span><span class="va">SSDvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HHMaj"</span>,<span class="st">"RHMaj"</span>,<span class="st">"FHSI"</span>,<span class="st">"TPML"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti1</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span>x<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                            struc<span class="op">=</span><span class="va">fauxil</span><span class="op">[</span><span class="va">fauxil</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Fauxil sp. 1"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                            compsex<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                            nResamp<span class="op">=</span><span class="fl">100</span>,</span></span>
<span class="r-in"><span>                            datastruc<span class="op">=</span><span class="st">"complete"</span>,</span></span>
<span class="r-in"><span>                            methsMulti <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            methsUni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            matchvars<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                            replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledMulti Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable names: HHMaj, RHMaj, FHSI, TPML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSD, MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (multivariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GMM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate sampling with complete or missing data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method, multivariate method,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     centering algorithm, and complete or missing data structure: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   proportion of missing data in resampling structure: 0.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITHOUT replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSDmulti1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or run 'getsampleaddresses' first</span></span></span>
<span class="r-in"><span><span class="va">addresses</span> <span class="op">&lt;-</span> <span class="fu"><a href="getsampleaddresses.html">getsampleaddresses</a></span><span class="op">(</span>comparative<span class="op">=</span></span></span>
<span class="r-in"><span>               <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               struc<span class="op">=</span><span class="va">fauxil</span><span class="op">[</span><span class="va">fauxil</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Fauxil sp. 1"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               compsex<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               nResamp<span class="op">=</span><span class="fl">100</span>, matchvars<span class="op">=</span><span class="cn">TRUE</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti2</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span>x<span class="op">=</span><span class="va">addresses</span>,</span></span>
<span class="r-in"><span>                            datastruc<span class="op">=</span><span class="st">"complete"</span>,</span></span>
<span class="r-in"><span>                            methsMulti <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            methsUni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti2</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledMulti Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable names: HHMaj, RHMaj, FHSI, TPML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SSD, MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (multivariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GMM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate sampling with complete or missing data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   complete</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method, multivariate method,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     centering algorithm, and complete or missing data structure: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   proportion of missing data in resampling structure: 0.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITHOUT replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSDmulti2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or run with missing data (exclude 'SSD' because some variables won't have both sexes)</span></span></span>
<span class="r-in"><span><span class="va">addresses</span> <span class="op">&lt;-</span> <span class="fu"><a href="getsampleaddresses.html">getsampleaddresses</a></span><span class="op">(</span>comparative<span class="op">=</span></span></span>
<span class="r-in"><span>               <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               struc<span class="op">=</span><span class="va">fauxil</span><span class="op">[</span><span class="va">fauxil</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Fauxil sp. 1"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               compsex<span class="op">=</span><span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>               nResamp<span class="op">=</span><span class="fl">100</span>, matchvars<span class="op">=</span><span class="cn">TRUE</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti3</span> <span class="op">&lt;-</span> <span class="fu">resampleSSD</span><span class="op">(</span>x<span class="op">=</span><span class="va">addresses</span>,</span></span>
<span class="r-in"><span>                            datastruc<span class="op">=</span><span class="st">"both"</span>,</span></span>
<span class="r-in"><span>                            methsMulti <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            methsUni <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gorSSDmulti3</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         dimorphResampledMulti Object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparative data set:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of specimens: 47 female, 47 male</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of variables: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   variable names: HHMaj, RHMaj, FHSI, TPML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (univariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MMR, BDI</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SSD estimate methods (multivariate):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   GMM</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Centering algorithms:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   geometric mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate sampling with complete or missing data:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   complete and missing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of unique combinations of univariate method, multivariate method,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     centering algorithm, and complete or missing data structure: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Resampling data structure:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   type of resampling: Monte Carlo</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of resampled data sets: 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   missing data resampling structure: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sampling individuals, then imposing missing data pattern</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of individuals in each resampled data set: 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   proportion of missing data in resampling structure: 0.625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   subsamples sampled WITHOUT replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   other resampling parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     sex data present</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ratio variables (if present): natural log of ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     matchvars = TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     na.rm = TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gorSSDmulti3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="resampleSSD-6.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Gordon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

