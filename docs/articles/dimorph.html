<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Size dimorphism estimation, confidence intervals, and significance tests with `dimorph` • dimorph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Size dimorphism estimation, confidence intervals, and significance tests with `dimorph`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dimorph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/dimorph.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="dimorph_files/kePrint-0.0.1/kePrint.js"></script><link href="dimorph_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Size dimorphism estimation, confidence intervals, and significance tests with `dimorph`</h1>
            
            <h4 data-toc-skip class="date">2025-10-26</h4>
      

      <div class="d-none name"><code>dimorph.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adamdgordon.github.io/dimorph/">dimorph</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The primary functions in the <code>dimorph</code> package are
<code><a href="../reference/dimorph.html">dimorph()</a></code>, <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, and
<code><a href="../reference/SSDtest.html">SSDtest()</a></code>. The function <code><a href="../reference/dimorph.html">dimorph()</a></code> allows users
flexibility in calculating or estimating sexual size dimorphism in
univariate or multivariate data sets, with or without missing data. The
function <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> generates confidence intervals for
those estimates, and the function <code><a href="../reference/SSDtest.html">SSDtest()</a></code> performs
resampling-based significance tests when comparing estimates for two or
more samples. This vignette will walk through how to use these
functions, although more specific detail on function arguments and
further examples can be found in the help page for each function. Also,
the performance of each of these methods under various conditions is
summarized and explored in detail in Gordon (2025a), with some further
extensions developed in Gordon (2025b).</p>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>The dimorphism metrics in this package all require numerical data for
one or more variables and for one or more groups of observations
(typically species or populations) in which there are expected to be at
most two size morphs. Calculation of dimorphism itself requires
specification of the size morph category (typically sex), although most
of the dimorphism estimators included here do not require that
information. Observations of metric data may include
<code>NA</code>s.</p>
<p>There are several previously published data sets in the
<code>dimorph</code> package which we can use to explore the functions
in this package. We’ll focus on two: <code>apelimbart</code> and
<code>GordonAJBA</code> (detailed information for each of these packages
can be found using <code><a href="../reference/apelimbart.html">help(apelimbart)</a></code>and
<code><a href="../reference/GordonAJBA.html">help(GordonAJBA)</a></code>).</p>
<div class="section level3">
<h3 id="apelimbart">
<code>apelimbart</code><a class="anchor" aria-label="anchor" href="#apelimbart"></a>
</h3>
<p>The <code>apelimbart</code> data set was pubished as supplemental
material in Gordon (2025a). It includes sex information and metric data
for ten postcranial variables collected for western gorillas, modern
humans, common chimpanzees, and lar gibbons. Every specimen is complete
for all variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">apelimbart</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    376 obs. of  16 variables:</span></span>
<span><span class="co">#&gt;  $ Species      : Factor w/ 4 levels "Gorilla gorilla",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Museum       : Factor w/ 10 levels "AIMZ","AMNH",..: 1 3 3 3 3 3 3 3 3 3 ...</span></span>
<span><span class="co">#&gt;  $ Collection.ID: chr  "13488" "HTB 1423" "HTB 1710" "HTB 1725" ...</span></span>
<span><span class="co">#&gt;  $ Sex          : Factor w/ 2 levels "F","M": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Wild         : Factor w/ 4 levels "Yes","Unknown",..: 2 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Mass.kg      : num  NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ FHSI         : num  42.8 42 39.9 40.4 41.2 ...</span></span>
<span><span class="co">#&gt;  $ TPML         : num  75.9 75 66.3 68.7 71.1 ...</span></span>
<span><span class="co">#&gt;  $ TPMAP        : num  47.1 47.9 41.4 43.8 42.9 ...</span></span>
<span><span class="co">#&gt;  $ TPLAP        : num  35.8 34.2 29.7 28.9 32.4 ...</span></span>
<span><span class="co">#&gt;  $ HHMaj        : num  53.2 52.4 48.2 46.1 51.4 ...</span></span>
<span><span class="co">#&gt;  $ HHMin        : num  45.8 46.8 43 40.8 45.9 ...</span></span>
<span><span class="co">#&gt;  $ RHMaj        : num  29.3 27.7 25.5 27.8 27.9 ...</span></span>
<span><span class="co">#&gt;  $ RHMin        : num  28.3 27.5 24.7 26.8 27.1 ...</span></span>
<span><span class="co">#&gt;  $ RDAP         : num  21 19.6 19.6 19.1 19.3 ...</span></span>
<span><span class="co">#&gt;  $ RDML         : num  33.5 28.4 25.5 30.3 29.1 ...</span></span></code></pre></div>
<p>We can visualize some of the data:</p>
<p><img src="dimorph_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="gordonajba">
<code>GordonAJBA</code><a class="anchor" aria-label="anchor" href="#gordonajba"></a>
</h3>
<p>The <code>GordonAJBA</code> data set was pubished as supplemental
material in Gordon (2025b). It includes sex information and metric data
for eight postcranial variables collected for western lowland gorillas,
modern humans, central chimpanzees, and the fossil species
<em>Australopithecus afarensis</em> and <em>A. africanus</em>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">GordonAJBA</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    189 obs. of  14 variables:</span></span>
<span><span class="co">#&gt;  $ Taxon      : Factor w/ 5 levels "Gorilla","Homo",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Species    : Factor w/ 5 levels "Gorilla gorilla",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Sex        : Factor w/ 3 levels "F","M","U": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ HUMHEAD    : num  50.3 46.6 50.1 49.9 49.4 ...</span></span>
<span><span class="co">#&gt;  $ ELBOW0.5   : num  38.5 36.6 35.3 37.8 37.8 ...</span></span>
<span><span class="co">#&gt;  $ RADTV      : num  27.5 25.8 26.5 26.4 26.5 ...</span></span>
<span><span class="co">#&gt;  $ FEMHEAD    : num  39.2 40.7 38.6 41.5 42.8 ...</span></span>
<span><span class="co">#&gt;  $ FEMSHAFT0.5: num  32.8 32.1 34.2 30.6 30.9 ...</span></span>
<span><span class="co">#&gt;  $ DISTFEM0.5 : num  52.5 48 48.8 50.2 51.3 ...</span></span>
<span><span class="co">#&gt;  $ PROXTIB0.5 : num  56.3 57.6 52.7 56.3 56.9 ...</span></span>
<span><span class="co">#&gt;  $ DISTTIB0.5 : num  27.9 28.3 25.3 27.9 27.5 ...</span></span>
<span><span class="co">#&gt;  $ Stratum    : Factor w/ 7 levels "SH-1","SH-2",..: NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ Age.old    : num  NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ Age.young  : num  NA NA NA NA NA NA NA NA NA NA ...</span></span></code></pre></div>
<p>Again, let’s visualize some of the data:</p>
<pre><code><span><span class="co">#&gt; Warning: Removed 44 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_point()`).</span></span></code></pre>
<p><img src="dimorph_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>Although the above plot only includes one fossil specimen, that’s
because this data set includes fossils with missing observations, and
only one specimen includes both of the plotted variables (that warning
message is reporting the number of specimens that don’t record both
measurements in the plot). Here’s a look at the first few fossil
specimens in that data set:</p>
<table class="table table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
Species
</th>
<th style="text-align:left;">
Sex
</th>
<th style="text-align:right;">
HUMHEAD
</th>
<th style="text-align:right;">
ELBOW0.5
</th>
<th style="text-align:right;">
RADTV
</th>
<th style="text-align:right;">
FEMHEAD
</th>
<th style="text-align:right;">
FEMSHAFT0.5
</th>
<th style="text-align:right;">
DISTFEM0.5
</th>
<th style="text-align:right;">
PROXTIB0.5
</th>
<th style="text-align:right;">
DISTTIB0.5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A.L. 128-1/129-1
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.6
</td>
<td style="text-align:right;">
37.5
</td>
<td style="text-align:right;">
39.9
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 137-48a
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 152-2
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
33.1
</td>
<td style="text-align:right;">
19.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 211-1
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
28.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 288-1
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
27.3
</td>
<td style="text-align:right;">
20.5
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
28.6
</td>
<td style="text-align:right;">
20.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
40.3
</td>
<td style="text-align:right;">
18.1
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 322-1
</td>
<td style="text-align:left;">
A. afarensis
</td>
<td style="text-align:left;">
U
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>The function <code><a href="../reference/dimorph.html">dimorph()</a></code> has two procedures for estimating
dimorphism in multivariate data sets with missing data, although one of
those procedures has been argued to be highly flawed (more on this
below).</p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-size-dimorphism-with-dimorph">Estimating size dimorphism with <code>dimorph()</code><a class="anchor" aria-label="anchor" href="#estimating-size-dimorphism-with-dimorph"></a>
</h2>
<p>The function <code><a href="../reference/dimorph.html">dimorph()</a></code> allows users to calculate actual
dimorphism (as a ratio of male size divided by female size) or any of
several published estimators of dimorphism. These can be calculated for
univariate data sets, multivariate data sets with complete observations
for all individuals and variables, or multivariate data sets with
missing data. Below we’ll work through how to use <code><a href="../reference/dimorph.html">dimorph()</a></code>
to generate these different values for different types of data. In
addition, the help page for <code><a href="../reference/dimorph.html">dimorph()</a></code> has more detail about
all of the arguments that can be modified as well as more examples
illustrating their effects.</p>
<div class="section level3">
<h3 id="univariate-estimates">Univariate estimates<a class="anchor" aria-label="anchor" href="#univariate-estimates"></a>
</h3>
<p>The argument <code>method</code> in <code><a href="../reference/dimorph.html">dimorph()</a></code> takes a
character string specifying the univariate method used to calculate or
estimate dimorphism for a vector of values <code>x</code>, which should
not be log-transformed in advance. The argument <code>center</code>
specifies whether <code><a href="../reference/dimorph.html">dimorph()</a></code> should log-transform the data
or not for certain procedures, but providing logged values to
<code><a href="../reference/dimorph.html">dimorph()</a></code> will result in the calculation of ratios of
logged data, which are mathematically nonsensical (although differences
in logged data are equivalent to log-transformed ratios). The methods
available in <code><a href="../reference/dimorph.html">dimorph()</a></code> include the calculation for actual
sexual size dimorphism, and also estimation techniques that fall into
three general types of methods as distinguished by Gordon (2025a):
grouping methods, finite mixture model methods, and variance-based
methods. Options include:</p>
<div class="section level4">
<h4 id="actual-dimorphism">Actual dimorphism<a class="anchor" aria-label="anchor" href="#actual-dimorphism"></a>
</h4>
<ul>
<li>
<code>"SSD"</code>: <strong>Sexual Size Dimorphism.</strong> Follows
Smith (1999). Calculates actual sexual dimorphism in the sample as the
ratio of mean male size to mean female size (often referred to in the
paleoanthropological literature as the Index of Sexual Dimorphism, ISD).
Sex-specific means are calculated as geometric means by default (the
argument <code>center = "geomean"</code>) but they can be calculated as
arithmetic means (<code>center = "mean"</code>). Requires the argument
<code>sex</code> to be specified. This is the default procedure for
<code><a href="../reference/dimorph.html">dimorph()</a></code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="grouping-methods">Grouping methods<a class="anchor" aria-label="anchor" href="#grouping-methods"></a>
</h4>
<p>These methods all use algorithms that separate a sample into two
groups and produces a single ratio based on one or more ratios of larger
measurements to smaller measurements. None of these methods requires sex
information.</p>
<ul>
<li><p><code>"MMR"</code>: <strong>Mean Method Ratio.</strong> Follows
Godfrey et al. (1993). This procedure splits the sample at its mean,
then calculates the ratio of the mean of measurements larger than the
overall mean to the mean of measurements smaller than the overall mean.
If any measurements are exactly equal to the overall mean, they
contribute to both the larger and smaller group as half an individual in
a weighted mean. Depending on <code>center</code>, the overall mean and
subgroup means are calculated either as geometric means or arithmetic
means. Ignores <code>sex</code>.</p></li>
<li><p><code>"BDI"</code>: <strong>Binomial Dimorphism Index.</strong>
Follows Reno et al. (2003). Given <em>n</em> measurements, this
calculates all possible ratios of the mean of larger specimens to the
mean of smaller specimens when the sample is split into the <em>k</em>
largest specimens and <em>n</em>-<em>k</em> smallest specimens, where
<em>k</em> ranges from 1 to <em>n</em>-1. A weighted mean is then
calculated for all ratios, where the weights are equal to the
probability of <em>k</em> successes in <em>n</em> trials in a binomial
distribution where <em>p</em>=0.5. Depending on <code>center</code>,
means are calculated either as geometric means or arithmetic means.
Ignores <code>sex</code>.</p></li>
<li><p><code>"ERM"</code>: <strong>Exact Resampling Method.</strong>
Modification of Lee’s (2001) Assigned Resampling Method (ARM) following
Gordon (2025a). ARM is a resampling-based estimate of dimorphism that
repeatedly samples two values with replacement from <code>x</code>, then
calculates their ratio as long as both are neither more than 0.5
standard deviations above the mean or both 0.5 standard deviations below
the mean (otherwise the pair is rejected). ARM typically oversamples the
possible combination of two values sampled from a small sample (as
originally described it samples 1,000 pairs, whereas a sample of 20
measurements only has 210 possible pairs) and sampling with replacement
biases dimorphism estimates downwards by the incorporation of multiple
ratios of 1 whenever the same value is sampled twice and is not rejected
by retention criterion. <code>"ERM"</code> performs an exact resampling
of all possible pairs of values without replacement, but otherwise
follows Lee’s algorithm. Depending on <code>center</code>, the procedure
is applied in either logarithmic (<code>"geomean"</code>) or raw
(<code>"mean"</code>) data space. Ignores <code>sex</code>.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="finite-mixture-model-methods">Finite mixture model methods<a class="anchor" aria-label="anchor" href="#finite-mixture-model-methods"></a>
</h4>
<p>Instead of calculating ratios of some combinations of sample
measurements, these methods make assumptions about the underlying
distributions of female and male size that the sample is drawn from. The
methods then estimate the difference in population means of those
underlying distributions — not by assigning specimens to particular
distributions and calculating sample means, but by using the specimens
collectively to estimate population distribution parameters. None of
these methods requires sex information.</p>
<ul>
<li><p><code>"FMA"</code>: <strong>Finite Mixture Analysis.</strong>
Follows Godfrey et al. (1993). Assumes that the sample is a mixture of
two underlying normal or lognormal distributions, that the sample
contains an equal proportion of females and males, and that those two
subsamples have equal variance. It then estimates the maximum separation
of the two means. Depending on <code>center</code>, the underlying
distributions are treated as either normal (<code>"mean"</code>) or
lognormal (<code>"geomean"</code>). Ignores <code>sex</code>. Note that
Godfrey et al. specifically stated that this application is for when the
sample appears unimodal rather than bimodal (it was developed for
evaluating dimorphism in subfossil lemurs, members of a clade with very
low dimorphism).</p></li>
<li><p><code>"MoM"</code>: <strong>Method of Moments.</strong> Follows
Josephson et al. (1996). Assumes that the sample is a mixture of two
underlying lognormal distributions, that the sample contains an equal
proportion of females and males, and that those two subsamples have
equal variance. It then uses three moments around the mean of the logged
combined sex distribution to estimate the difference in means of the
underlying lognormal distributions. This calculation is always performed
on the log-transformed data regardless of the value of
<code>center</code>. Ignores <code>sex</code>.</p></li>
<li><p><code>"BFM"</code>: <strong>Bayesian Finite Mixture.</strong>
Follows Gordon (2025). Assumes that the sample is a finite mixture of
two underlying normal or lognormal distributions. Unlike
<code>"FMA"</code> and <code>"MoM"</code>, it estimates the proportion
of females and males assuming that they may not be equal, and uses a
Bayesian Information Criterion (BIC) approach to select between a model
that estimates a single variance for both sexes and a model that
estimates variances separately for the two constituent distributions
using <code>mclustBIC</code>. It then calculates the ratio of the two
estimated means. Depending on center, the underlying distributions are
treated as either normal (<code>"mean"</code>) or lognormal
(<code>"geomean"</code>). Ignores <code>sex</code>. When performed on
lognormal data, this method is similar to the pdPeak method of Sasaki et
al. (2021), particularly when the BIC procedure selects an equal
variance model (which it typically does).</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="variance-based-methods">Variance-based methods<a class="anchor" aria-label="anchor" href="#variance-based-methods"></a>
</h4>
<p>These methods avoid making any assumptions about sex identity or
underlying distribution parameters, and instead simply calculate a
measure of variability in proportional size for the whole sample.</p>
<ul>
<li><p><code>"CV"</code>: <strong>Coefficient of Variation.</strong>
Calculates the coefficient of variation as the standard deviation of
<code>x</code> divided by the mean of <code>x</code> then multiplied by
100. This calculation is always performed on the raw data regardless of
the value of center (an analogous method using logarithmic data is
<code>"sdlog"</code>). Ignores <code>sex</code>. Additionally, Sokal and
Braumann’s (1980) size correction factor can be applied by setting
<code>ncorrection</code> to <code>TRUE</code>, although this is
<code>FALSE</code> by default.</p></li>
<li><p><code>"CVsex"</code>: <strong>Modified Coefficient of
Variation.</strong> Calculates a modified version of the coefficient of
variation: the standard deviation is replaced by the square root of the
sum of squared differences of every value of <code>x</code> from the
unweighted mean of the sex-specific means in <code>x</code> divided by
the square root of <em>n</em>-1, and this is divided by the unweighted
mean of the sex-specific means, then multiplied by 100. This calculation
is always performed on the raw data regardless of the value of center
(an analogous method using logarithmic data is <code>"sdlogsex"</code>).
Requires <code>sex</code>. Additionally, Sokal and Braumann’s (1980)
size correction factor can be applied by setting
<code>ncorrection</code> to <code>TRUE</code>, although this is
<code>FALSE</code> by default.</p></li>
<li><p><code>"sdlog"</code>: <strong>Standard Deviation of Logged
Data.</strong> First, <code>x</code> is log-transformed using the
natural logarithm, then the standard deviation is calculated. This is a
measure of proportional variation of the values of <code>x</code> about
their geometric mean; i.e., analagous to the coefficient of variation
for a lognormal distribution. This calculation is always performed on
the log-transformed data regardless of the value of center (an analogous
method using raw data is <code>"CV"</code>). Ignores
<code>sex</code>.</p></li>
<li><p><code>"sdlogsex"</code>: <strong>Modified Standard Deviation of
Logged Data.</strong> First, <code>x</code> is log-transformed using the
natural logarithm. Then a modified version of standard deviation is
calculated: the square root of the sum of squared differences of every
logged value of <code>x</code> from the unweighted mean of the
sex-specific means of log-transformed <code>x</code>, divided by the
square root of <em>n</em>-1. This calculation is always performed on the
log-transformed data regardless of the value of <code>center</code> (an
analogous method using raw data is <code>"CVsex"</code>). Requires
<code>sex</code>.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="applying-the-methods">Applying the methods<a class="anchor" aria-label="anchor" href="#applying-the-methods"></a>
</h4>
<p>Let’s explore the application of each of these methods. First, let’s
pull out data for a single species, western gorillas, from the
<code>apelimbart</code> data object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gorillas</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>,<span class="op">]</span></span></code></pre></div>
<p>Now let’s calculate actual dimorphism for a single variable in this
sample, femoral head superoinferior diameter (FHSI).
<code><a href="../reference/dimorph.html">dimorph()</a></code> expects a vector of numeric values provided as
the initial argument, <code>x</code>. For some methods it also requires
a vector specifying the sex of each specimen (supplied to the argument
<code>sex</code>), otherwise an error will be generated. If the argument
<code>sex</code> includes <code>NA</code>s, either those specimens will
be dropped before calculating dimorphism or the function will return
<code>NA</code>, depending on the value of argument
<code>na.rm</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gorSSD</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"SSD"</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span></span>
<span><span class="va">gorSSD</span></span>
<span><span class="co">#&gt;     SSD </span></span>
<span><span class="co">#&gt; 1.22447</span></span></code></pre></div>
<p>Dimorphism is always returned as a ratio of values in the original
(unlogged) units rather than the logarithm of that ratio, even when it
is calculated using logged data (which is effectively what happens when
using the geometric means of raw data, the default behavior of the
function <code><a href="../reference/dimorph.html">dimorph()</a></code>).</p>
<p>The function <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> provides more detailed
information, including the number of variables (always 1 for univariate
analyses), the number of specimens included in the analysis (this
excludes specimens with missing data in univariate analyses), the
proportion of females in the sample when sex information is included,
the mean function (geometric or arithmetic) used on the data, and the
estimated means for the numerator and denominator of the dimorphism
ratio for every method that calculates them. These are sex-specific male
and female means in the case of actual dimorphism. Also reported is
information specific to multivariate analyses that will be addressed
later.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gorSSD</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.22447</span></span>
<span><span class="co">#&gt; univariate method: SSD</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 49.98, 40.81</span></span></code></pre></div>
<p>Now let’s take a look at the various methods for estimating
dimorphism, starting with the grouping methods. These are all methods
that estimate dimorphism in the absence of information about the sex of
each specimen by splitting a sample into two sub-samples of larger and
smaller specimens. They also all return an estimate of dimorphism as a
ratio of values.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"MMR"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.2261</span></span>
<span><span class="co">#&gt; univariate method: MMR</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 49.69, 40.52</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"BDI"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.2243</span></span>
<span><span class="co">#&gt; univariate method: BDI</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"ERM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.18265</span></span>
<span><span class="co">#&gt; univariate method: ERM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span></code></pre></div>
<p>Notice that only <code>"MMR"</code> reports a numerator and
denominator mean. All three methods split the sample into larger and
smaller measurements to calculate a ratio. But while <code>"MMR"</code>
only does so once, <code>"BDI"</code> and <code>"ERM"</code> do so
multiple times, and in those cases the full set of numerators and
denominators are not stored in the resulting object (to save
memory).</p>
<p>Now for the finite mixture model methods.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"FMA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.1292</span></span>
<span><span class="co">#&gt; univariate method: FMA</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 47.99, 42.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"MoM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.22663</span></span>
<span><span class="co">#&gt; univariate method: MoM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"BFM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.21998</span></span>
<span><span class="co">#&gt; univariate method: BFM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 49.72, 40.75</span></span>
<span><span class="co">#&gt; BFM model parameters:</span></span>
<span><span class="co">#&gt;   BFM estimate of proportion of sample composed of smaller sex: 0.48289</span></span>
<span><span class="co">#&gt;   BFM model of variance: equal for both sexes</span></span>
<span><span class="co">#&gt;   BFM estimate of variance: 0.00354 (logged data)</span></span></code></pre></div>
<p>Unlike the grouping methods, these models do not assign individual
specimens to groups, but rather use them collectively to estimate
properties of the underlying distributions that they are sampled from.
<code>"MoM"</code> estimates the difference in the means of two
lognormal distributions rather than the means themselves, so no
numerator or denominator values are calculated. <code>"FMA"</code> and
<code>"BFM"</code> do estimate the population means, so those estimates
are provided, and <code>"BFM"</code> includes additional information
about the finite mixture model.</p>
<p>And finally, the variance-based methods. Unlike all of the other
methods, these do not provide direct estimates of dimorphism ratios.
Instead, they are estimates of proportional size variation in the
sample. Methods based on the coefficient of variation can opt to apply
the sample size correction factor of Sokal and Braumann (1980) by
specifying <code>ncorrection = TRUE</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CV"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 11.65676</span></span>
<span><span class="co">#&gt; univariate method: CV</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: arithmetic mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CV"</span>, ncorrection<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 11.68776</span></span>
<span><span class="co">#&gt; univariate method: CV (sample size correction factor applied)</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: arithmetic mean</span></span></code></pre></div>
<p>The values for <code>"CV"</code> estimates are unitless, expressing
the standard deviation of the sample as a percentage of the arithmetic
mean of the sample. Note that the mean function for <code>"CV"</code> is
always the arithmetic mean, regardless of the user-specified value of
<code>center</code>. An analogous method using the geometric mean is
<code>"sdlog"</code>, discussed below.</p>
<p>If sex designation data is available for all specimens, the method
<code>"CVsex"</code> can be used. Rather than using the mean of the
entire data set in the calculation of standard deviation and CV, the
mean of sex-specific means is used instead. This counteracts bias
introduced by uneven sex ratios and/or different variances for the
sex-specific distributions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CVsex"</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 11.65676</span></span>
<span><span class="co">#&gt; univariate method: CVsex</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: arithmetic mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CVsex"</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span>, ncorrection<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 11.68776</span></span>
<span><span class="co">#&gt; univariate method: CVsex (sample size correction factor applied)</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: arithmetic mean</span></span></code></pre></div>
<p>In addition to <code>"CV"</code>, an alternative (and arguably better
- see Gordon, 2025a) method for measuring relative variability is to
calculate the standard deviation of logged data (<code>"sdlog"</code>),
which is also a measure of proportional dispersion in the sample. Like
<code>"CV"</code> and <code>"CVsex"</code>, there is also a version of
this approach that uses the mean of sex-specific means rather than the
overall mean when calculating standard deviation
(<code>"sdlogsex"</code>).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"sdlog"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 0.11642</span></span>
<span><span class="co">#&gt; univariate method: sdlog</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"sdlogsex"</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 0.11642</span></span>
<span><span class="co">#&gt; univariate method: sdlogsex</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span></code></pre></div>
<p>The values for these estimates are in the units of difference in the
logged original data. According to the log rules,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>l</mi><mi>o</mi><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mi>/</mi><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">log(a)-log(b)=log(a/b)</annotation></semantics></math>,
so these units are equivalent to units for the logarithm of ratios,
which are unitless. The standard deviation of logged data is essentially
an average of proportional deviation of observations around the
geometric mean of a sample. Note that the mean function for
<code>"sdlog"</code> and <code>"sdlogsex"</code> is always the geometric
mean, regardless of the user-specified value of <code>center</code>.</p>
<p>An easier way to compare all of these different estimates is by using
the argument <code>dfout</code>. Setting it to <code>TRUE</code> makes
<code><a href="../reference/dimorph.html">dimorph()</a></code> output information in a data frame format that
can be combined across different estimates.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allmethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"SSD"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"MMR"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"BDI"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"ERM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"FMA"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"MoM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"BFM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CV"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"CVsex"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"sdlog"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">FHSI</span>, method<span class="op">=</span><span class="st">"sdlogsex"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span>, sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
Let’s take a look at what this generates.
<table class="table table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:left;">
methodUni
</th>
<th style="text-align:left;">
methodMulti
</th>
<th style="text-align:left;">
center
</th>
<th style="text-align:right;">
n.vars.overall
</th>
<th style="text-align:right;">
n.specimens.overall
</th>
<th style="text-align:right;">
proportion.female.overall
</th>
<th style="text-align:right;">
n.vars.realized
</th>
<th style="text-align:right;">
n.specimens.realized
</th>
<th style="text-align:right;">
proportion.female.realized
</th>
<th style="text-align:right;">
proportion.missingdata.overall
</th>
<th style="text-align:right;">
proportion.missingdata.realized
</th>
<th style="text-align:left;">
proportion.templated
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
SSD
</td>
<td style="text-align:right;">
1.224470
</td>
<td style="text-align:left;">
SSD
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MMR
</td>
<td style="text-align:right;">
1.226097
</td>
<td style="text-align:left;">
MMR
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
BDI
</td>
<td style="text-align:right;">
1.224297
</td>
<td style="text-align:left;">
BDI
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ERM
</td>
<td style="text-align:right;">
1.182654
</td>
<td style="text-align:left;">
ERM
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
FMA
</td>
<td style="text-align:right;">
1.129200
</td>
<td style="text-align:left;">
FMA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
MoM
</td>
<td style="text-align:right;">
1.226632
</td>
<td style="text-align:left;">
MoM
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
BFM
</td>
<td style="text-align:right;">
1.219985
</td>
<td style="text-align:left;">
BFM
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
CV
</td>
<td style="text-align:right;">
11.656756
</td>
<td style="text-align:left;">
CV
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
mean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
CVsex
</td>
<td style="text-align:right;">
11.656756
</td>
<td style="text-align:left;">
CVsex
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
mean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
sdlog
</td>
<td style="text-align:right;">
0.116417
</td>
<td style="text-align:left;">
sdlog
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
sdlogsex
</td>
<td style="text-align:right;">
0.116417
</td>
<td style="text-align:left;">
sdlogsex
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>As mentioned above, several of these columns are only relevant for
estimates of dimorphism based on multivariate data sets with missing
data. Let’s take a look at how <code><a href="../reference/dimorph.html">dimorph()</a></code> handles
multivariate data.</p>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-estimates">Multivariate estimates<a class="anchor" aria-label="anchor" href="#multivariate-estimates"></a>
</h3>
<p>The argument <code>methodMulti</code> in <code><a href="../reference/dimorph.html">dimorph()</a></code> takes
a character string specifying the multivariate method used to calculate
or estimate dimorphism for a matrix or dataframe of metric values
<code>x</code> (note that regardless of the value of this argument,
multivariate estimation procedures will only be carried out if
<code>x</code> is a multivariate data set). As with the univariate
methods, values in <code>x</code> should not be log-transformed. Options
for <code>methodMulti</code> include:</p>
<ul>
<li><p>“GMsize”: If <code>x</code> is a dataframe or matrix, this method
first calculates overall size as the geometric mean of measurements in
all variables for those specimens that are complete for all variables in
the data set. The selected univariate method is then applied to this
measure of overall size. If any specimens are missing data, those
specimens will be dropped from the analysis if <code>na.rm=TRUE</code>,
or the function will return <code>NA</code> if
<code>na.rm=FALSE</code>.</p></li>
<li><p>“GMM”: This method follows the Geometric Mean Method of Gordon et
al. (2008). The selected univariate method is applied to all variables
separately (where specimens missing data for a given variable are
ignored). Then the geometric mean is calculated of the dimorphism
estimates for all variables, producing a single estimate of dimorphism
for the whole data set. Note that this methodology is not appropriate
for variance-based univariate methods; i.e., <code>"CV"</code>,
<code>"CVsex"</code>, <code>"sdlog"</code>, and <code>"sdlogsex"</code>
(see Gordon 2025a for a detailed explanation). This method is the
default for <code>methodMulti</code>.</p></li>
<li><p>“TM”: This method follows the Template Method of Reno et
al. (2003). A variable of interest is specified by the user with the
argument <code>templatevar</code>. The algorithm identifies a template
individual that can be used to estimate the largest number of values for
the selected variable of interest. It does so by calculating ratios
between the value of the variable of interest and other variables in the
template individual, which are then multiplied by the value of those
other variables in individuals missing the target variable. The template
individual selected is the specimen that allows for the largest number
of target variable estimates, maximizing the data set for that variable.
A user-selected univariate method is then applied to the combined data
set of actual and estimated values for the target variable. Note that
this method has been critiqued by several authors on multiple grounds
(see Gordon 2025a for a summary of those critiques and references), and
is only included here for the sake of completeness.</p></li>
</ul>
<div class="section level4">
<h4 id="equivalence-of-gmsize-and-gmm-ssd-values-with-complete-data">Equivalence of <code>"GMsize"</code> and <code>"GMM"</code> SSD
values with complete data<a class="anchor" aria-label="anchor" href="#equivalence-of-gmsize-and-gmm-ssd-values-with-complete-data"></a>
</h4>
<p>To begin with, let’s calculate actual dimorphism for a sample with
complete data using the <code>"GMsize"</code> multivariate method in
conjunction with the <code>"SSD"</code> univariate method. We’ll do so
using all ten linear variables for the gorilla sample in
<code>apelimbart</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SSDvars_apelimbart</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FHSI"</span>, <span class="st">"TPML"</span>, <span class="st">"TPMAP"</span>, <span class="st">"TPLAP"</span>, <span class="st">"HHMaj"</span>,</span>
<span>                        <span class="st">"HHMin"</span>, <span class="st">"RHMaj"</span>, <span class="st">"RHMin"</span>, <span class="st">"RDAP"</span>, <span class="st">"RDML"</span><span class="op">)</span></span>
<span><span class="va">Gg_GMsize</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">[</span>,<span class="va">SSDvars_apelimbart</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"SSD"</span>, methodMulti<span class="op">=</span><span class="st">"GMsize"</span>,</span>
<span>                     sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Gg_GMsize</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.25506</span></span>
<span><span class="co">#&gt; univariate method: SSD</span></span>
<span><span class="co">#&gt; multivariate method: GMsize</span></span>
<span><span class="co">#&gt; no. of variables (overall): 1 (geometric mean of 10 variables)</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 1 (geometric mean of 10 variables)</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 45.78, 36.48</span></span></code></pre></div>
<p>The summary of <code>Gg_GMsize</code> records the number of variables
as <code>"1 (geometric mean of 10 variables)"</code>. That’s because
overall size is calculated for each specimen (as the geometric mean for
all ten measurements for that specimen), reducing the data set to a
single variable of overall size, and then dimorphism is calculated for
that one measure of size. That also allows the ratio numerator and
denominator to be reported. That will be different when using
<code>"GMM"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gg_GMM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gorillas</span><span class="op">[</span>,<span class="va">SSDvars_apelimbart</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"SSD"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>,</span>
<span>                  sex<span class="op">=</span><span class="va">gorillas</span><span class="op">$</span><span class="va">Sex</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Gg_GMM</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.25506</span></span>
<span><span class="co">#&gt; univariate method: SSD</span></span>
<span><span class="co">#&gt; multivariate method: GMM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 10</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): 0.5</span></span>
<span><span class="co">#&gt; no. of variables (realized): 10</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 94</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): 0.5</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span></code></pre></div>
<p>Here, dimorphism is calculated separately for each variable and then
combined into a single value. So the summary of <code>Gg_GMM</code>
reports the number of variables simply as 10, and it doesn’t report the
ratio numerator and denominator because there are ten ratios that are
combined to give the final dimorphism estimate.</p>
<p>But notice that <code>"GMsize"</code> and <code>"GMM"</code> produce
identical measures of SSD in this case, despite calculating it in two
different ways: <code>"GMsize"</code> first calculates a geometric mean
of all measurements for each specimen to get a measure of overall size,
then calculates <code>"SSD"</code> for that measure of overall size;
<code>"GMM"</code> first calculates <code>"SSD"</code> separately for
all ten variables, then calculates the geometric mean of all ten
measures of <code>"SSD"</code>. Gordon et al. (2008) demonstrated that
these are mathematically identical procedures when all specimens are
complete for all measurements. And it’s not the case that this is
dependent on complete separation in size between the sexes - we can see
that the same property also holds for gibbons, which have virtually no
dimorphism and a high degree of overlap between sex-specific
distributions.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gibbons</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Hylobates lar"</span>,<span class="op">]</span></span>
<span><span class="va">bothmethods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gibbons</span><span class="op">[</span>,<span class="va">SSDvars_apelimbart</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"SSD"</span>, methodMulti<span class="op">=</span><span class="st">"GMsize"</span>,</span>
<span>                             sex<span class="op">=</span><span class="va">gibbons</span><span class="op">$</span><span class="va">Sex</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">gibbons</span><span class="op">[</span>,<span class="va">SSDvars_apelimbart</span><span class="op">]</span>, method<span class="op">=</span><span class="st">"SSD"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>,</span>
<span>                             sex<span class="op">=</span><span class="va">gibbons</span><span class="op">$</span><span class="va">Sex</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Printing <code>bothmethods</code> produces the following, with
identical values for dimorphism using either multivariate method:</p>
<table class="table table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:left;">
methodUni
</th>
<th style="text-align:left;">
methodMulti
</th>
<th style="text-align:left;">
center
</th>
<th style="text-align:right;">
n.vars.overall
</th>
<th style="text-align:right;">
n.specimens.overall
</th>
<th style="text-align:right;">
proportion.female.overall
</th>
<th style="text-align:right;">
n.vars.realized
</th>
<th style="text-align:right;">
n.specimens.realized
</th>
<th style="text-align:right;">
proportion.female.realized
</th>
<th style="text-align:right;">
proportion.missingdata.overall
</th>
<th style="text-align:right;">
proportion.missingdata.realized
</th>
<th style="text-align:left;">
proportion.templated
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GMsize.SSD
</td>
<td style="text-align:right;">
1.028516
</td>
<td style="text-align:left;">
SSD
</td>
<td style="text-align:left;">
GMsize
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.SSD
</td>
<td style="text-align:right;">
1.028516
</td>
<td style="text-align:left;">
SSD
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:left;">
NA
</td>
</tr>
</tbody>
</table>
<p>Note that <code>"GMsize"</code> calculates a geometric mean of all
included variables, so it cannot be used in cases where there is any
missing data. However, because <code>"GMM"</code> calculates dimorphism
(or some estimate of dimorphism) separately for each variable, then
combines them with a geometric mean, it can be used for any data set
where each variable is represented by at least two specimens.</p>
<p>Often data sets that are missing metric data are also missing sex
identification for specimens (e.g. fossil data sets). The property of
equality between <code>"GMsize"</code> and <code>"GMM"</code> with
complete metric data applies to <code>"SSD"</code> alone, which requires
sex information, although other ratio-based estimates that don’t require
sex information approach equality using the two multivariate methods. By
extension, using the <code>"GMM"</code> multivariate method in
conjunction with any of the ratio-based univariate methods provides
close estimates of <code>"GMsize"</code> values. However,
<code>"GMM"</code> cannot be used with any of the variance-based
univariate methods (i.e., <code>"CV"</code>, <code>"CVsex"</code>,
<code>"sdlog"</code>, <code>"sdlogsex"</code>). This is because a
geometric mean of variance-based estimates across multiple variables
will only equal the value for the same variance-based estimator
calculated for overall size if all of the variables are perfectly
correlated with each other (Gordon, 2025a), which effectively never
happens with morphological data.</p>
</div>
<div class="section level4">
<h4 id="missing-data-applications-gmm">Missing data applications: <code>"GMM"</code><a class="anchor" aria-label="anchor" href="#missing-data-applications-gmm"></a>
</h4>
<p>So let’s turn our attention to the two multivariate methods that do
allow for missing data, <code>"GMM"</code> and <code>"TM"</code>. We’ll
start with the geometric mean method (<code>"GMM"</code>), which was
developed by Gordon et al. (2008) in response to concerns over the
earlier template method (<code>"TM"</code>). The <code>"GMM"</code>
procedure is explained above, although more detail can be found in
Gordon et al. (2008) and Gordon (2025a).</p>
<p>For these examples, we’ll turn to the <code>GordonAJBA</code> data
set (published in Gordon, 2025b) to estimate dimorphism for a sample of
eight postcranial linear measurements for the fossil hominin
<em>Australopithecus afarensis</em>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SSDvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HUMHEAD"</span>, <span class="st">"ELBOW0.5"</span>, <span class="st">"RADTV"</span>, <span class="st">"FEMHEAD"</span>,    </span>
<span>             <span class="st">"FEMSHAFT0.5"</span>, <span class="st">"DISTFEM0.5"</span>, <span class="st">"PROXTIB0.5"</span>, <span class="st">"DISTTIB0.5"</span><span class="op">)</span></span>
<span><span class="va">Aafarensis</span> <span class="op">&lt;-</span> <span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. afarensis"</span>, <span class="va">SSDvars</span><span class="op">]</span></span></code></pre></div>
<p>Let’s take a look at the data.</p>
<table class="table table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
HUMHEAD
</th>
<th style="text-align:right;">
ELBOW0.5
</th>
<th style="text-align:right;">
RADTV
</th>
<th style="text-align:right;">
FEMHEAD
</th>
<th style="text-align:right;">
FEMSHAFT0.5
</th>
<th style="text-align:right;">
DISTFEM0.5
</th>
<th style="text-align:right;">
PROXTIB0.5
</th>
<th style="text-align:right;">
DISTTIB0.5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A.L. 128-1/129-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.6
</td>
<td style="text-align:right;">
37.5
</td>
<td style="text-align:right;">
39.9
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 137-48a
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 152-2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
33.1
</td>
<td style="text-align:right;">
19.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 211-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
28.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 288-1
</td>
<td style="text-align:right;">
27.3
</td>
<td style="text-align:right;">
20.5
</td>
<td style="text-align:right;">
15.0
</td>
<td style="text-align:right;">
28.6
</td>
<td style="text-align:right;">
20.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
40.3
</td>
<td style="text-align:right;">
18.1
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 322-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 330-6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
52.9
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
40.2
</td>
<td style="text-align:right;">
31.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
45.6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.7
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-7
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
24.8
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-42
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
50.6
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-96
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
21.0
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-107
</td>
<td style="text-align:right;">
35.1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333-131
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
33.9
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333w-40
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
30.8
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333w-56
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
45.0
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333x-14
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
22.2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 333x-26
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
52.2
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
A.L. 827-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
38.0
</td>
<td style="text-align:right;">
23.6
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
<p>As you can see, there’s quite a bit of missing data across the
sample, and no specimen is complete for all variables. Now let’s use the
<code>"MMR"</code> univariate method in conjunction with the
<code>"GMM"</code> multivariate method to estimate dimorphism in this
sample.</p>
<p>When samples are missing data, some specimens and/or variables may
not meet the criteria for inclusion in the analysis, in which case
<code><a href="../reference/dimorph.html">dimorph()</a></code> generates a warning message and removes them
before estimating dimorphism. In the case of <code>"GMM"</code>, all
variables must include at least two observations so that dimorphism can
be estimated for each variable; any variables that don’t are removed,
and any specimens that no longer have observations are also removed.
Setting <code>details=TRUE</code> when running <code><a href="../reference/dimorph.html">dimorph()</a></code>
records additional information about the specific set of variables and
specimens that make it into the analysis.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Aa_GMM</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MMR"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Aa_GMM</span></span>
<span><span class="co">#&gt;  GMM.MMR </span></span>
<span><span class="co">#&gt; 1.280896</span></span></code></pre></div>
<p>In this particular sample, all variables and specimens are usable
with the <code>"GMM"</code> method. We can take a detailed look at the
results by using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> with
<code>verbose=TRUE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Aa_GMM</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.2809</span></span>
<span><span class="co">#&gt; univariate method: MMR</span></span>
<span><span class="co">#&gt; multivariate method: GMM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 8</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 20</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 8</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 20</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0.80625</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0.80625</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Included variables:</span></span>
<span><span class="co">#&gt; HUMHEAD</span></span>
<span><span class="co">#&gt; ELBOW0.5</span></span>
<span><span class="co">#&gt; RADTV</span></span>
<span><span class="co">#&gt; FEMHEAD</span></span>
<span><span class="co">#&gt; FEMSHAFT0.5</span></span>
<span><span class="co">#&gt; DISTFEM0.5</span></span>
<span><span class="co">#&gt; PROXTIB0.5</span></span>
<span><span class="co">#&gt; DISTTIB0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Included specimens:</span></span>
<span><span class="co">#&gt; A.L. 128-1/129-1</span></span>
<span><span class="co">#&gt; A.L. 137-48a</span></span>
<span><span class="co">#&gt; A.L. 152-2</span></span>
<span><span class="co">#&gt; A.L. 211-1</span></span>
<span><span class="co">#&gt; A.L. 288-1</span></span>
<span><span class="co">#&gt; A.L. 322-1</span></span>
<span><span class="co">#&gt; A.L. 330-6</span></span>
<span><span class="co">#&gt; A.L. 333-3</span></span>
<span><span class="co">#&gt; A.L. 333-4</span></span>
<span><span class="co">#&gt; A.L. 333-6</span></span>
<span><span class="co">#&gt; A.L. 333-7</span></span>
<span><span class="co">#&gt; A.L. 333-42</span></span>
<span><span class="co">#&gt; A.L. 333-96</span></span>
<span><span class="co">#&gt; A.L. 333-107</span></span>
<span><span class="co">#&gt; A.L. 333-131</span></span>
<span><span class="co">#&gt; A.L. 333w-40</span></span>
<span><span class="co">#&gt; A.L. 333w-56</span></span>
<span><span class="co">#&gt; A.L. 333x-14</span></span>
<span><span class="co">#&gt; A.L. 333x-26</span></span>
<span><span class="co">#&gt; A.L. 827-1</span></span></code></pre></div>
<p>When <code>verbose=TRUE</code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> provides a
list of included variables and included specimens. Regardless of the
value of <code>verbose</code>, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> provides some
information that wasn’t relevant for univariate analyses. The output
makes a distinction between “overall” and “realized” for number of
variables, number of specimens, and proportion of females in the sample.
“Overall” refers to the data set provided to <code><a href="../reference/dimorph.html">dimorph()</a></code>,
while “realized” refers to the data set actually used to estimate
dimorphism; i.e., the remaining sample after any ineligible variables
and/or individuals have been removed.</p>
<p>In addition, <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> also reports the proportion of
missing data in both the provided sample and in the sample that remains
after excluding ineligible variables and specimens. This is simply the
number of <code>NAs</code> in the data set divided by the total number
of sells in the data matrix (in this case, 8 variables times 20
individuals = 160). In this particular data set, about 80.6% of the data
matrix contains <code>NA</code>s.</p>
</div>
<div class="section level4">
<h4 id="missing-data-applications-tm-use-with-caution">Missing data applications: <code>"TM"</code> (use with
caution!)<a class="anchor" aria-label="anchor" href="#missing-data-applications-tm-use-with-caution"></a>
</h4>
<blockquote>
<p>To estimate dimorphism using the template method, we not only have to
set <code>methodMulti="TM"</code>, but we also have to specify which
variable should be the template variable. This is the variable that
dimorphism will be estimated for; it is measured directly in specimens
that preserve it, and it is estimated in specimens that don’t have it.
That estimation occurs as follows. A template specimen is identified by
<code><a href="../reference/dimorph.html">dimorph()</a></code> that preserves the template variable and several
other variables. To estimate the value of the template variable in a
specimen that doesn’t preserve it, the value of a variable in that
specimen that is also found in the template specimen is multiplied by
the corresponding ratio in the template specimen.</p>
<p><strong>Important note: this procedure is equivalent to a regression
procedure with zero degrees of freedom (and thus has infinitely large
prediction intervals) that assumes an isometric relationship between all
variables and zero variation around regression lines for all data
points.</strong> These assumptions will always be violated, and previous
research has shown that the template method produces a high degree of
error in estimates of the template variable and resulting dimorphism
estimates, which translates into low power for significance tests based
on the template method (Gordon 2025a).</p>
<p>That said, <strong>and stressing that the template method should not
be used</strong>, let’s see how to apply it in <code><a href="../reference/dimorph.html">dimorph()</a></code>.
We’ll use the same <em>A. afarensis</em> data set and univariate method
(<code>"MMR"</code>) that we used for the <code>"GMM"</code> method.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Aa_TM</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MMR"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>, </span>
<span>                 templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span>, details<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following variable(s) were removed because they</span></span>
<span><span class="co">#&gt; were not included in the template specimen:</span></span>
<span><span class="co">#&gt; DISTFEM0.5</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following specimens(s) were removed because they</span></span>
<span><span class="co">#&gt; did not have templatable variables:</span></span>
<span><span class="co">#&gt; A.L. 333-4</span></span>
<span><span class="co">#&gt; A.L. 333w-56</span></span>
<span><span class="va">Aa_TM</span></span>
<span><span class="co">#&gt;   TM.MMR </span></span>
<span><span class="co">#&gt; 1.232086</span></span></code></pre></div>
<p>In the case of <code>"TM"</code>, any variables that aren’t present
in the template specimen are removed, and any specimens that don’t
preserve either the template variable or a variable in the template
specimen are removed. The warnings in the output above note those
removals for this particular data set. We can get a bit more information
from <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Aa_TM</span>, verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; estimate: 1.23209</span></span>
<span><span class="co">#&gt; univariate method: MMR</span></span>
<span><span class="co">#&gt; multivariate method: TM</span></span>
<span><span class="co">#&gt; no. of variables (overall): 8</span></span>
<span><span class="co">#&gt; no. of specimens (overall): 20</span></span>
<span><span class="co">#&gt; female proportion of sample (overall): unknown</span></span>
<span><span class="co">#&gt; no. of variables (realized): 7</span></span>
<span><span class="co">#&gt; no. of specimens (realized): 18</span></span>
<span><span class="co">#&gt; female proportion of sample (realized): unknown</span></span>
<span><span class="co">#&gt; proportion of missing data (overall): 0.80625</span></span>
<span><span class="co">#&gt; proportion of missing data (realized): 0.79365</span></span>
<span><span class="co">#&gt; proportion of template variable data estimated: 0.77778</span></span>
<span><span class="co">#&gt; template specimen: A.L. 288-1</span></span>
<span><span class="co">#&gt; mean function: geometric mean</span></span>
<span><span class="co">#&gt; ratio numerator and denominator: 39.72, 32.24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Included variables:</span></span>
<span><span class="co">#&gt; HUMHEAD</span></span>
<span><span class="co">#&gt; ELBOW0.5</span></span>
<span><span class="co">#&gt; RADTV</span></span>
<span><span class="co">#&gt; FEMHEAD</span></span>
<span><span class="co">#&gt; FEMSHAFT0.5</span></span>
<span><span class="co">#&gt; PROXTIB0.5</span></span>
<span><span class="co">#&gt; DISTTIB0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Included specimens:</span></span>
<span><span class="co">#&gt; A.L. 128-1/129-1</span></span>
<span><span class="co">#&gt; A.L. 137-48a</span></span>
<span><span class="co">#&gt; A.L. 152-2</span></span>
<span><span class="co">#&gt; A.L. 211-1</span></span>
<span><span class="co">#&gt; A.L. 288-1</span></span>
<span><span class="co">#&gt; A.L. 330-6</span></span>
<span><span class="co">#&gt; A.L. 333-3</span></span>
<span><span class="co">#&gt; A.L. 333-4</span></span>
<span><span class="co">#&gt; A.L. 333-6</span></span>
<span><span class="co">#&gt; A.L. 333-7</span></span>
<span><span class="co">#&gt; A.L. 333-42</span></span>
<span><span class="co">#&gt; A.L. 333-96</span></span>
<span><span class="co">#&gt; A.L. 333-131</span></span>
<span><span class="co">#&gt; A.L. 333w-40</span></span>
<span><span class="co">#&gt; A.L. 333w-56</span></span>
<span><span class="co">#&gt; A.L. 333x-14</span></span>
<span><span class="co">#&gt; A.L. 333x-26</span></span>
<span><span class="co">#&gt; A.L. 827-1</span></span></code></pre></div>
<p>Because some variables and specimens were removed by
<code><a href="../reference/dimorph.html">dimorph()</a></code>, there is a difference in the reported “overall”
and “realized” values. The number of variables dropped from 8 overall to
7 realized, the number of specimens dropped from 20 overall to 18
realized, and the proportion of missing data dropped from 0.80625
overall to 0.7936508 realized.</p>
<p>Note that the proportion of missing data has decreased - there is
proportionally more data - because it is measured as a proportion of the
newly reduced data set, not as a proportion of the original data set.
Also, for the <code>"TM"</code> multivariate method,
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> reports the proportion of the template variable
values that are estimated. In this case, 77.78% of FEMHEAD values were
estimated using the template method, corrresponding to 14 of 18 values -
only 4 FEMHEAD values were actually measured directly.</p>
</blockquote>
</div>
<div class="section level4">
<h4 id="missing-data-applications-full-set-of-allowable-methodmulti-and-method-combinations">Missing data applications: full set of allowable
<code>methodMulti</code> and <code>method</code> combinations<a class="anchor" aria-label="anchor" href="#missing-data-applications-full-set-of-allowable-methodmulti-and-method-combinations"></a>
</h4>
<p>Below is the full set of combinations of unviariate and multivariate
methods that can be applied to multivariate data sets with missing data
(even including methods that shouldn’t be used!). We can use the
function <code><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings()</a></code> to prevent warnings about the
removal of variables and specimens from popping up for all of the
<code>"TM"</code> estimates.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Aa_various</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MMR"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MMR"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"BDI"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"BDI"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"ERM"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"ERM"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"FMA"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"FMA"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MoM"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"MoM"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"BFM"</span>, methodMulti<span class="op">=</span><span class="st">"GMM"</span>, dfout<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"BFM"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"CV"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/dimorph.html">dimorph</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Aafarensis</span>, method<span class="op">=</span><span class="st">"sdlog"</span>, methodMulti<span class="op">=</span><span class="st">"TM"</span>,</span>
<span>                            dfout<span class="op">=</span><span class="cn">TRUE</span>, templatevar<span class="op">=</span><span class="st">"FEMHEAD"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following variable(s) were removed because they did not include</span></span>
<span><span class="co">#&gt; at least three measurements (required for BFM):</span></span>
<span><span class="co">#&gt; HUMHEAD, RADTV</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following specimen(s) were removed because they did not include</span></span>
<span><span class="co">#&gt; at least one measurement after variables were removed:</span></span>
<span><span class="co">#&gt; A.L. 333-107, A.L. 333x-14</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following variable(s) were removed because they generated</span></span>
<span><span class="co">#&gt; NA estimates:</span></span>
<span><span class="co">#&gt; ELBOW0.5</span></span>
<span><span class="co">#&gt; Warning in dimorph:::dimorphMulti(x = x, methodUni = method, methodMulti = methodMulti, : The following specimen(s) were removed because they did not include</span></span>
<span><span class="co">#&gt; at least one measurement after variables were removed:</span></span>
<span><span class="co">#&gt; A.L. 137-48a, A.L. 322-1</span></span></code></pre></div>
<p>Notice that there is still a set of warnings that pop up - these
relate to the <code>"BFM"</code> and <code>"GMM"</code> method
combination because <code>"BFM"</code> requires more observations than
other methods, and some of these variables have sample sizes that are
too small to use it. When variables are dropped, as in that case,
estimates are no longer comparable with other estimation techniques
unless those other estimates are also recalculated using the same set of
variables and specimens. The default behavior of <code><a href="../reference/dimorph.html">dimorph()</a></code>
is to still report the dimorphism estimate when based on fewer than the
full set of variables (argument <code>completevars=FALSE</code>).
However, users can set <code>completevars=TRUE</code> which requires
<code>"GMM"</code> to only report estimates when all variables are
involved in their calculation, otherwise an NA is returned
(<em>N.B.</em>: all resampling methods automatically set
<code>completevars=TRUE</code>).</p>
<p>Also, <code>"TM"</code> estimates are not directly comparable to
<code>"GMM"</code> (or <code>"GMsize"</code>) estimates because the
former are estimates of dimorphism in the template variable, while the
latter are estimates of dimorphism in the geometric mean of all included
variables (i.e., a measure of overall size).</p>
<p>In addition, the set of methods above does not include any of the
methods that require sex information (i.e., <code>"SSD"</code>,
<code>"CVsex"</code>, and <code>"sdlogsex"</code>). We could add in
those methods in the rare cases where you have missing metric data but
sex information for each specimen, but this will rarely (if ever!) apply
to fossil samples. Also, the combinations above do not include
<code>"CV"</code> or <code>"sdlog"</code> for the <code>"GMM"</code>
multivariate method for the reasons explained above (trying to use any
of those combinations will produce an error), although those methods can
be used by the <code>"TM"</code> multivariate method. Let’s take a look
at <code>Aa_various</code>.</p>
<table class="table table table-condensed" style="font-size: 10px; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:left;">
methodUni
</th>
<th style="text-align:left;">
methodMulti
</th>
<th style="text-align:left;">
center
</th>
<th style="text-align:right;">
n.vars.overall
</th>
<th style="text-align:right;">
n.specimens.overall
</th>
<th style="text-align:left;">
proportion.female.overall
</th>
<th style="text-align:right;">
n.vars.realized
</th>
<th style="text-align:right;">
n.specimens.realized
</th>
<th style="text-align:right;">
proportion.female.realized
</th>
<th style="text-align:right;">
proportion.missingdata.overall
</th>
<th style="text-align:right;">
proportion.missingdata.realized
</th>
<th style="text-align:right;">
proportion.templated
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
GMM.MMR
</td>
<td style="text-align:right;">
1.2808958
</td>
<td style="text-align:left;">
MMR
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.8062500
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.MMR
</td>
<td style="text-align:right;">
1.2320855
</td>
<td style="text-align:left;">
MMR
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.BDI
</td>
<td style="text-align:right;">
1.2600194
</td>
<td style="text-align:left;">
BDI
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.8062500
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.BDI
</td>
<td style="text-align:right;">
1.2289661
</td>
<td style="text-align:left;">
BDI
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.ERM
</td>
<td style="text-align:right;">
1.2657344
</td>
<td style="text-align:left;">
ERM
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.8062500
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.ERM
</td>
<td style="text-align:right;">
1.1840341
</td>
<td style="text-align:left;">
ERM
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.FMA
</td>
<td style="text-align:right;">
1.2603156
</td>
<td style="text-align:left;">
FMA
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.8062500
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.FMA
</td>
<td style="text-align:right;">
1.2067259
</td>
<td style="text-align:left;">
FMA
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.MoM
</td>
<td style="text-align:right;">
1.3864090
</td>
<td style="text-align:left;">
MoM
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.8062500
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.MoM
</td>
<td style="text-align:right;">
1.2355143
</td>
<td style="text-align:left;">
MoM
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
GMM.BFM
</td>
<td style="text-align:right;">
1.2850260
</td>
<td style="text-align:left;">
BFM
</td>
<td style="text-align:left;">
GMM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7000000
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.BFM
</td>
<td style="text-align:right;">
1.3064170
</td>
<td style="text-align:left;">
BFM
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.CV
</td>
<td style="text-align:right;">
13.1718911
</td>
<td style="text-align:left;">
CV
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
mean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
<tr>
<td style="text-align:left;">
TM.sdlog
</td>
<td style="text-align:right;">
0.1329545
</td>
<td style="text-align:left;">
sdlog
</td>
<td style="text-align:left;">
TM
</td>
<td style="text-align:left;">
geomean
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.80625
</td>
<td style="text-align:right;">
0.7936508
</td>
<td style="text-align:right;">
0.7777778
</td>
</tr>
</tbody>
</table>
<p>There’s a wide range of values produced by these different estimation
techniques, so they’re not terribly informative on their own and without
quantification of uncertainty in those estimates. Let’s add some
context.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="calculating-confidence-intervals-with-bootdimorph">Calculating confidence intervals with
<code>bootdimorph()</code><a class="anchor" aria-label="anchor" href="#calculating-confidence-intervals-with-bootdimorph"></a>
</h2>
<p>The two primary functions that provide that context are
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> and <code><a href="../reference/SSDtest.html">SSDtest()</a></code>, which both rely
on the function <code><a href="../reference/resampleSSD.html">resampleSSD()</a></code>. <code><a href="../reference/resampleSSD.html">resampleSSD()</a></code>
will not be covered here, but it provides great flexibility in setting
up resampling procedures for any of the dimorphism estimation methods
outlined above. See the help page for <code><a href="../reference/resampleSSD.html">resampleSSD()</a></code> for
various examples.</p>
<p>We’ll begin by considering <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>. This is the
function used to generate confidence intervals around dimorphism
estimates. It uses a bootstrapping procedure, and it can be applied to
univariate data sets or complete multivariate data sets, but not
multivariate data sets with missing data (we’ll address those kinds of
data sets later).</p>
<div class="section level3">
<h3 id="confidence-intervals-for-univariate-data-sets">Confidence intervals for univariate data sets<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-univariate-data-sets"></a>
</h3>
<p>First, let’s separate the <code>apelimbart</code> data set into four
objects each containing the data for one species.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gor</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>,<span class="op">]</span></span>
<span><span class="va">hom</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>,<span class="op">]</span></span>
<span><span class="va">pan</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>,<span class="op">]</span></span>
<span><span class="va">hyl</span> <span class="op">&lt;-</span> <span class="va">apelimbart</span><span class="op">[</span><span class="va">apelimbart</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Hylobates lar"</span>,<span class="op">]</span></span></code></pre></div>
<p>Now we’ll specify the number of resampling iterations we’ll use for
all of the iterative procedures in the rest of this vignette. In
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> this is specified by the argument
<code>nResamp</code>, which defaults to 1,000. For this vignette we’ll
bump it up to 5,000; in order to only have to specify this value once,
we’ll set the value of an object <code>nResample</code> to 5,000 and
we’ll pass <code>nResample</code> to <code>nResamp</code> in all later
code. If you’re cutting and pasting code to run these examples on your
own just to make sure they work, reducing the value of
<code>nResample</code> to a small number (like 10 or 100) will let these
functions run much faster on your computer.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nResample</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span></code></pre></div>
<p><code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> can generate confidence intervals for
multiple estimation methods at the same time, so we’ll create a vector
<code>meths</code> that we’ll pass to the argument <code>methsUni</code>
in <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>. Let’s just do all of the univariate
methods.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span>, <span class="st">"ERM"</span>, <span class="st">"FMA"</span>, <span class="st">"MoM"</span>, <span class="st">"BFM"</span>, <span class="st">"CV"</span>, <span class="st">"CVsex"</span>, <span class="st">"sdlog"</span>, <span class="st">"sdlogsex"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="applying-bootdimoph-to-univariate-samples">Applying <code>bootdimoph()</code> to univariate samples<a class="anchor" aria-label="anchor" href="#applying-bootdimoph-to-univariate-samples"></a>
</h4>
<p>Now we can run <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> on our four species. Let’s
use the variable FHSI again. Note that we can pass that variable to
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> (and <code><a href="../reference/dimorph.html">dimorph()</a></code>) in various ways.
All of the following will work (as will pulling a single vector from a
matrix instead of a data frame, or just giving the function any numeric
vector):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># these lines of code are not actually being evaluated</span></span>
<span><span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">$</span><span class="va">FHSI</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">[</span>,<span class="st">"FHSI"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>But because of how R extracts single variables from data frames, only
the last line of code above will pass the name of the variable to
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>. Whether or not that name is included has no
impact on the values generated by the function, only on whether or not
the name of the variable is preserved in the object produced by
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>. We’ll use that last version in the
applications of <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> below to preserve the name of
the variable.</p>
<p>Now let’s generate confidence intervals for all four species
samples.</p>
<blockquote>
<p><em>Technical note:</em> As with all functions in R that rely on
random number generators, we can create reproducible examples by using
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> to set the initial state of the random number
generator. This step is not necessary, but it does allow for completely
reproducible results. <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> sets the initial condition
for the whole session, but in the following example we could repeat it
before each run of <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>. Because the sample sizes
are the same across all four species, this will produce identical
bootstrap samples across all four taxa in the sense that, if the
hundredth bootstrap sample for gorillas samples the fourth specimen 3
times and the fifth specimen not at all, that will also be true for the
hundredth human bootstrap sample, the hundredth chimpanzee bootstrap
sample, and the hundredth gibbon bootstrap sample. However, that only
holds true because the samples are identically sized.</p>
</blockquote>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5782</span><span class="op">)</span> <span class="co"># not necessary, but generates reproducible example - see technical note above</span></span>
<span><span class="va">bootsUgor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, sex<span class="op">=</span><span class="va">gor</span><span class="op">$</span><span class="va">Sex</span>, methsUni<span class="op">=</span><span class="va">meths</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5782</span><span class="op">)</span> <span class="co"># not necessary, but generates reproducible example - see technical note above</span></span>
<span><span class="va">bootsUhom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">hom</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, sex<span class="op">=</span><span class="va">hom</span><span class="op">$</span><span class="va">Sex</span>, methsUni<span class="op">=</span><span class="va">meths</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5782</span><span class="op">)</span> <span class="co"># not necessary, but generates reproducible example - see technical note above</span></span>
<span><span class="va">bootsUpan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">pan</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, sex<span class="op">=</span><span class="va">pan</span><span class="op">$</span><span class="va">Sex</span>, methsUni<span class="op">=</span><span class="va">meths</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5782</span><span class="op">)</span> <span class="co"># not necessary, but generates reproducible example - see technical note above</span></span>
<span><span class="va">bootsUhyl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">hyl</span><span class="op">[</span>,<span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, sex<span class="op">=</span><span class="va">hyl</span><span class="op">$</span><span class="va">Sex</span>, methsUni<span class="op">=</span><span class="va">meths</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span></code></pre></div>
<p>None of these data sets are missing data, but if they were then
either specimens with missing data would be dropped (if
<code>na.rm=TRUE</code>, the default) or an error would be generated (if
<code>na.rm=FALSE</code>).</p>
</div>
<div class="section level4">
<h4 id="viewing-the-resulting-object">Viewing the resulting object<a class="anchor" aria-label="anchor" href="#viewing-the-resulting-object"></a>
</h4>
<p>Let’s take a look at one of the resulting objects.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootsUgor</span></span>
<span><span class="co">#&gt;         dimorphResampledUni Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;   number of specimens: 47 female, 47 male</span></span>
<span><span class="co">#&gt;   number of variables: 1</span></span>
<span><span class="co">#&gt;   variable name: FHSI</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   SSD, MMR, BDI, ERM, FMA, MoM, BFM, CV, CVsex, sdlog, sdlogsex</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean, arithmetic mean</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method and centering algorithm: 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;   type of resampling: Monte Carlo</span></span>
<span><span class="co">#&gt;   number of resampled data sets: 5000</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 94</span></span>
<span><span class="co">#&gt;   resampling procedure: bootstrap</span></span>
<span><span class="co">#&gt;   subsamples sampled WITH replacement</span></span>
<span><span class="co">#&gt;   confidence intervals: two-sided, 95% confidence level</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     sex data present</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals for estimates:</span></span>
<span><span class="co">#&gt;    methodUni  center  lower_lim  upper_lim</span></span>
<span><span class="co">#&gt; 1        SSD geomean  0.1795724  0.2252887</span></span>
<span><span class="co">#&gt; 2        MMR geomean  0.1798128  0.2252718</span></span>
<span><span class="co">#&gt; 3        BDI geomean  0.1771237  0.2223086</span></span>
<span><span class="co">#&gt; 4        ERM geomean  0.1448760  0.1887641</span></span>
<span><span class="co">#&gt; 5        FMA geomean  0.1121673  0.1215098</span></span>
<span><span class="co">#&gt; 6        MoM geomean  0.1744214  0.2279261</span></span>
<span><span class="co">#&gt; 7        BFM geomean  0.1720392  0.2240756</span></span>
<span><span class="co">#&gt; 8         CV    mean 10.4463771 12.6668469</span></span>
<span><span class="co">#&gt; 9      CVsex    mean 10.5047823 12.7139217</span></span>
<span><span class="co">#&gt; 10     sdlog geomean  0.1045775  0.1265123</span></span>
<span><span class="co">#&gt; 11  sdlogsex geomean  0.1050792  0.1269293</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals for bias of estimates from sample SSD, CVsex, or sdlogsex:</span></span>
<span><span class="co">#&gt;   methodUni  center    lower_lim    upper_lim</span></span>
<span><span class="co">#&gt; 1       MMR geomean -0.004126886  0.004121011</span></span>
<span><span class="co">#&gt; 2       BDI geomean -0.012241845  0.001017986</span></span>
<span><span class="co">#&gt; 3       ERM geomean -0.045156407 -0.028896766</span></span>
<span><span class="co">#&gt; 4       FMA geomean -0.104426534 -0.060249338</span></span>
<span><span class="co">#&gt; 5       MoM geomean -0.011910930  0.005700959</span></span>
<span><span class="co">#&gt; 6       BFM geomean -0.012470815  0.003621685</span></span>
<span><span class="co">#&gt; 7        CV    mean -0.402367896  0.086797550</span></span>
<span><span class="co">#&gt; 8     sdlog geomean -0.002438665  0.000000000</span></span></code></pre></div>
<p>There’s a lot of information in there. First, information about the
data set is provided: the number of specimens, broken down by sex if
that information is provided, and the number and name of included
variables. Next is information about the univariate methods, centering,
algorithms, and number of unique combinations of the two.</p>
<p>It also provides information about the resampling data structure.
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> has the arguments <code>exact</code> and
<code>limit</code> that are passed to <code><a href="../reference/resampleSSD.html">resampleSSD()</a></code> and
determine whether Monte Carlo or exact resampling is used. If
<code>exact=TRUE</code> the function will calculate how many unique
resampled datasets exist, and if that number is less than or equal to
<code>limit</code>, exact resampling is used where every possible unique
combination of <em>n</em> values sampled with replacement from
<em>n</em> values is generated. If the number of unique combinations
exceeds <code>limit</code> then Monte Carlo resampling is used instead.
<code>limit</code> defaults to 50,000 but can be changed by the
user.</p>
<p>For <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, the number of individuals in each
resampled data set will equal the number of specimens in the sample and
the resampling procedure will always be “bootstrap” in which subsamples
are sampled with replacement. The reported confidence level and
sidedness information depends on the arguments <code>conf.level</code>
(which defaults to <code>0.95</code>) and <code>alternative</code>
(which defaults to <code>"two.sided"</code>). Any other resampling
information is also provided. Notice that confidence intervals for
ratio-based methods are reported as logged ratios by default; this is
due to ratios typically being lognormally distributed (see Smith, 1999,
and Gordon, 2025a for further discussion of this point).</p>
<p>Finally, the confidence limits themselves are reported for each
applied method. Notice that in this case there are also confidence
intervals “for bias of estimates from sample SSD, CVsex, or sdlogsex”.
Whenever any of these three methods that require sex information are
included in the set of methods <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> uses, then the
bias of estimators that don’t use sex information is also calculated.
For ratio based estimators, this is the bias of sample estimates from
sample <code>"SSD"</code> for each bootstrapped subsample; for
<code>"CV"</code> it is the bias of sample <code>"CV"</code> from sample
<code>"Cvsex"</code> for each subsample, and for <code>"sdlog"</code> it
is the bias of sample <code>"sdlog"</code> from sample
<code>"sdlogsex"</code> for each subsample.</p>
</div>
<div class="section level4">
<h4 id="structure-of-the-object">Structure of the object<a class="anchor" aria-label="anchor" href="#structure-of-the-object"></a>
</h4>
<p>We can also extract quite a bit of information from this object.
Objects produced by <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> for univariate data sets
are of class <code>dimorphResampledUni</code>, which are lists of up to
four components: <code>estimates</code>, <code>sampleADS</code>,
<code>CI</code>, and <code>CIbias</code>. In practice you won’t have to
dig into these objects to get the information you want, but you may want
to. Let’s take a look at the structure of <code>bootsUgor</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bootsUgor</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ estimates:'data.frame':   55000 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;   ..$ estimate                  : num [1:55000] 0.212 0.214 0.195 0.216 0.215 ...</span></span>
<span><span class="co">#&gt;   ..$ methodUni                 : Factor w/ 11 levels "SSD","MMR","BDI",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ center                    : Factor w/ 2 levels "geomean","mean": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ n.specimens.overall       : int [1:55000] 94 94 94 94 94 94 94 94 94 94 ...</span></span>
<span><span class="co">#&gt;   ..$ proportion.female.overall : num [1:55000] 0.585 0.521 0.521 0.479 0.511 ...</span></span>
<span><span class="co">#&gt;   ..$ n.specimens.realized      : int [1:55000] 94 94 94 94 94 94 94 94 94 94 ...</span></span>
<span><span class="co">#&gt;   ..$ proportion.female.realized: num [1:55000] 0.585 0.521 0.521 0.479 0.511 ...</span></span>
<span><span class="co">#&gt;   ..$ subsampleID               : int [1:55000] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   ..$ bias                      : num [1:55000] NA NA NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "estvalues")= chr "logged"</span></span>
<span><span class="co">#&gt;  $ sampleADS:List of 11</span></span>
<span><span class="co">#&gt;   ..$ nResamp    : num 5000</span></span>
<span><span class="co">#&gt;   ..$ addresses  : int [1:94, 1:5000] 77 7 14 5 26 22 15 61 68 56 ...</span></span>
<span><span class="co">#&gt;   ..$ adlist     : NULL</span></span>
<span><span class="co">#&gt;   ..$ comparative:'data.frame':  94 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ FHSI: num [1:94] 42.8 42 39.9 40.4 41.2 ...</span></span>
<span><span class="co">#&gt;   ..$ compsex    : Factor w/ 2 levels "F","M": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ sex.female : num 1</span></span>
<span><span class="co">#&gt;   ..$ replace    : logi TRUE</span></span>
<span><span class="co">#&gt;   ..$ exact      : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ matchvars  : logi FALSE</span></span>
<span><span class="co">#&gt;   ..$ struc      :'data.frame':  94 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;   .. ..$ FHSI: num [1:94] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;   ..$ strucClass : chr "data.frame"</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "dimorphAds"</span></span>
<span><span class="co">#&gt;  $ CI       :'data.frame':   11 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;   ..$ methodUni: Factor w/ 11 levels "SSD","MMR","BDI",..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   ..$ center   : Factor w/ 2 levels "geomean","mean": 1 1 1 1 1 1 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;   ..$ lower_lim: num [1:11] 0.18 0.18 0.177 0.145 0.112 ...</span></span>
<span><span class="co">#&gt;   ..$ upper_lim: num [1:11] 0.225 0.225 0.222 0.189 0.122 ...</span></span>
<span><span class="co">#&gt;  $ CIbias   :'data.frame':   8 obs. of  4 variables:</span></span>
<span><span class="co">#&gt;   ..$ methodUni: Factor w/ 11 levels "SSD","MMR","BDI",..: 2 3 4 5 6 7 8 10</span></span>
<span><span class="co">#&gt;   ..$ center   : Factor w/ 2 levels "geomean","mean": 1 1 1 1 1 1 2 1</span></span>
<span><span class="co">#&gt;   ..$ lower_lim: num [1:8] -0.00413 -0.01224 -0.04516 -0.10443 -0.01191 ...</span></span>
<span><span class="co">#&gt;   ..$ upper_lim: num [1:8] 0.00412 0.00102 -0.0289 -0.06025 0.0057 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "class")= chr "dimorphResampledUni"</span></span>
<span><span class="co">#&gt;  - attr(*, "matchvars")= logi FALSE</span></span>
<span><span class="co">#&gt;  - attr(*, "replace")= logi TRUE</span></span>
<span><span class="co">#&gt;  - attr(*, "exact")= logi FALSE</span></span>
<span><span class="co">#&gt;  - attr(*, "na.rm")= logi TRUE</span></span>
<span><span class="co">#&gt;  - attr(*, "resampling")= chr "bootstrap"</span></span>
<span><span class="co">#&gt;  - attr(*, "conf.level")= num 0.95</span></span>
<span><span class="co">#&gt;  - attr(*, "alternative")= chr "two.sided"</span></span></code></pre></div>
<p>As you can see, <code>estimates</code> is a data frame. It holds all
of the bootstrapped estimates for each iteration of each method, as well
as the bias from the corresponding sample value using
<code>"SSD"</code>, <code>"CVsex"</code>, or <code>"sdlogsex"</code>.
There will be a number of rows equal to the number of methods times the
number of iterations in the bootstrapping prodecure
(<code>nResamp</code>).</p>
<p><code>CI</code>, and <code>CIbias</code> when present, are also data
frames. These are the tables providing the upper and lower confidence
intervals that are reported when the object is viewed. They are
calculated using a percentile bootstrap procedure applied to the values
in <code>estimates</code> using the user specified
<code>conf.level</code> and <code>alternative</code>. We can pull these
data frames using <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> and the argument
<code>type</code>, which defaults to <code>"estimate"</code> but can
also be set to <code>"bias"</code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">bootsUgor</span><span class="op">)</span></span>
<span><span class="co">#&gt;    methodUni  center lower_lim0.95 upper_lim0.95</span></span>
<span><span class="co">#&gt; 1        SSD geomean     0.1795724     0.2252887</span></span>
<span><span class="co">#&gt; 2        MMR geomean     0.1798128     0.2252718</span></span>
<span><span class="co">#&gt; 3        BDI geomean     0.1771237     0.2223086</span></span>
<span><span class="co">#&gt; 4        ERM geomean     0.1448760     0.1887641</span></span>
<span><span class="co">#&gt; 5        FMA geomean     0.1121673     0.1215098</span></span>
<span><span class="co">#&gt; 6        MoM geomean     0.1744214     0.2279261</span></span>
<span><span class="co">#&gt; 7        BFM geomean     0.1720392     0.2240756</span></span>
<span><span class="co">#&gt; 8         CV    mean    10.4463771    12.6668469</span></span>
<span><span class="co">#&gt; 9      CVsex    mean    10.5047823    12.7139217</span></span>
<span><span class="co">#&gt; 10     sdlog geomean     0.1045775     0.1265123</span></span>
<span><span class="co">#&gt; 11  sdlogsex geomean     0.1050792     0.1269293</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">bootsUgor</span>, type<span class="op">=</span><span class="st">"bias"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   methodUni  center lower_lim0.95 upper_lim0.95</span></span>
<span><span class="co">#&gt; 1       MMR geomean  -0.004126886   0.004121011</span></span>
<span><span class="co">#&gt; 2       BDI geomean  -0.012241845   0.001017986</span></span>
<span><span class="co">#&gt; 3       ERM geomean  -0.045156407  -0.028896766</span></span>
<span><span class="co">#&gt; 4       FMA geomean  -0.104426534  -0.060249338</span></span>
<span><span class="co">#&gt; 5       MoM geomean  -0.011910930   0.005700959</span></span>
<span><span class="co">#&gt; 6       BFM geomean  -0.012470815   0.003621685</span></span>
<span><span class="co">#&gt; 7        CV    mean  -0.402367896   0.086797550</span></span>
<span><span class="co">#&gt; 8     sdlog geomean  -0.002438665   0.000000000</span></span></code></pre></div>
<p>The remaining list element, <code>sampleADS</code>, is itself a list.
It preserves the resampling information, in particular the set of
specimens sampled for each iteration of the bootstrap
(<code>sampleADS$addresses</code>), as well as the original data set
(<code>sampleADS$comparative</code>). An important point to note here is
that all methods draw on the same set of resampled values, which is what
allows bias from sample <code>"SSD"</code>, <code>"CVsex"</code>, and/or
<code>"sdlogsex"</code> to be calculated.</p>
</div>
<div class="section level4">
<h4 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h4>
<p>Because the object also records all of the <code>nResamp</code>
bootstrapped values for every method, we can visualize the distribution
of these values and the confidence intervals. This can be done using
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUgor</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-39-1.png" width="672"></p>
<p>A violin plot is generated for the bootstrapped values associated
with each combination of univariate method and centering algorithm.
These are separated into panels by the units in which estimates are
measured: ratios (which are plotted as logged ratios), percentages (for
CV methods), and sdlog units. Vertical lines are drawn at the upper and
lower limits of the confidence intervals for each parameter estimate.
The confidence level can be adjusted in <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> using
the argument <code>conf.level</code>.</p>
<p>In each panel the vertical extent of the violin plots are scaled to
the same relative frequency across all method combinations. For this
particular example, the violin plots for all of the ratio methods except
<code>"FMA"</code> are highly compressed vertically because of the very
narrow range of estimates generated by <code>"FMA"</code>. If we want to
get a better sense of the shape of the other bootstrapped distributions,
we can exclude one or more univariate methods from the plot by passing
the names of those methods in a vector to the argument
<code>exclude</code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUgor</span>, exclude<span class="op">=</span><span class="st">"FMA"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-40-1.png" width="672"></p>
<p>We can now take a look at the bootstrapped confidence intervals for
the other three species samples. Here are humans:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUhom</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-41-1.png" width="672"></p>
<p>Now chimpanzees:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUpan</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-42-1.png" width="672"></p>
<p>And finally, gibbons:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUhyl</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-43-1.png" width="672"></p>
<p>These plots illustrate some of the issues to be aware of when using
these methods; e.g., patterns of over- or under-estimation of SSD under
certain conditions and the unusual distributions of finite mixture model
methods (<code>FMA"</code>, <code>"MoM"</code>, <code>"BFM"</code>)
under many conditions. These issues are all discussed in detail in
Gordon (2025a).</p>
<p>Additionally, in cases where bias has been calculated from sample
estimates of SSD or the other methods that include sex, the argument
<code>type</code> can be set to <code>"bias"</code> to plot bootstrapped
distributions and confidence intervals for bias. These plots are useful
in illustrating the degree of systematic bias for various methods
depending on the actual degree of dimorphism. We’ll just take a look at
the two samples with the most and least dimorphism, gorillas and
gibbons.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUgor</span>, type<span class="op">=</span><span class="st">"bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-44-1.png" width="672"></p>
<p>For ratio-based estimates, most estimators do a pretty good job of
matching actual sample sexual dimorphism in gorillas (confidence
intervals include zero), although <code>"FMA"</code> and
<code>"ERM"</code> underestimate it by quite a bit. However, all
ratio-based estimators overestimate dimorphism in gibbons:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUhyl</span>, type<span class="op">=</span><span class="st">"bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-45-1.png" width="672"></p>
<p>We can also take this opportunity to see how uneven sex ratios can
impact dimorphism estimates. Let’s recalculate a set of confidence
intervals for gorillas. But this time, instead of using the full data
set which has an equal number of females and males, let’s run it for a
subset that includes all 47 females but only 10 males, then look at bias
from sample <code>"SSD"</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootsUgorUnbalanced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span>, <span class="fl">71</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span>, <span class="st">"FHSI"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>                                   sex<span class="op">=</span><span class="va">gor</span><span class="op">$</span><span class="va">Sex</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">47</span>, <span class="fl">71</span><span class="op">:</span><span class="fl">80</span><span class="op">)</span><span class="op">]</span>, methsUni<span class="op">=</span><span class="va">meths</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsUgorUnbalanced</span>, type<span class="op">=</span><span class="st">"bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-47-1.png" width="672"></p>
<p>Looking back at the confidence intervals based on the full, balanced
gorilla sample, we can see that those 95% confidence intervals included
zero bias for all methods except for <code>"ERM"</code> and
<code>"FMA"</code>. But in this unbalanced sex sample (about 82%
females), all of the 95% confidence intervals exclude zero bias except
for <code>"BFM"</code>, and even in that case the confidence interval is
very large, with the lower confidence interval extending beyond the
lower interval for <code>"MMR"</code>, <code>"BDI"</code>, and
<code>"FMA"</code> (<em>N.B.</em>: <code>"BFM"</code> does well at
estimating dimorphism in unbalanced samples at large sample sizes
because it explicitly estimates the proportion of each sex present, but
it is a data-hungry model and performs poorly at the smaller sample
sizes typical of most fossil samples). See Gordon (2025a) for a thorough
discussion about the benefits and limitations of these various
estimation techniques.</p>
</div>
</div>
<div class="section level3">
<h3 id="confidence-intervals-for-multivariate-data-sets">Confidence intervals for multivariate data sets<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-multivariate-data-sets"></a>
</h3>
<p>We can also bootstrap multivariate estimates of dimorphism. Let’s do
it.</p>
<div class="section level4">
<h4 id="applying-bootdimoph-to-multivariate-samples">Applying <code>bootdimoph()</code> to multivariate samples<a class="anchor" aria-label="anchor" href="#applying-bootdimoph-to-multivariate-samples"></a>
</h4>
<p>Using <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> with multivariate samples requires
complete sets of observations for every specimen. If
<code>na.rm=TRUE</code> (the default), any specimen that is missing data
will be removed from the analysis. An error is returned if there are
missing data and <code>na.rm=FALSE</code>. Let’s bootstrap confidence
intervals for the gorilla sample using all ten variables in the
<code>apelimbart</code> data set, all univariate methods, and both the
<code>"GMsize"</code> and <code>"GMM"</code> multivariate methods
(<em>N.B.</em>: not only is the use of <code>"TM"</code> discouraged, it
also simply reverts to a univariate estimate of dimorphism in the
template variable when all specimens have data for the template variable
because no estimation for that variable is necessary).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootsMgor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bootdimorph.html">bootdimorph</a></span><span class="op">(</span><span class="va">gor</span><span class="op">[</span>,<span class="va">SSDvars_apelimbart</span><span class="op">]</span>, sex<span class="op">=</span><span class="va">gor</span><span class="op">$</span><span class="va">Sex</span>, methsUni<span class="op">=</span><span class="va">meths</span>,</span>
<span>                         methsMulti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span>, <span class="st">"GMsize"</span><span class="op">)</span>, nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="viewing-the-resulting-object-1">Viewing the resulting object<a class="anchor" aria-label="anchor" href="#viewing-the-resulting-object-1"></a>
</h4>
<p>Now let’s take a look at the resulting object. It has many
similarities with the univariate examples, but also some additional
information.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bootsMgor</span></span>
<span><span class="co">#&gt;         dimorphResampledMulti Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;   number of specimens: 47 female, 47 male</span></span>
<span><span class="co">#&gt;   number of variables: 10</span></span>
<span><span class="co">#&gt;   variable names: FHSI, TPML, TPMAP, TPLAP, HHMaj, HHMin, RHMaj, RHMin, RDAP, RDML</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   SSD, MMR, BDI, ERM, FMA, MoM, BFM, CV, CVsex, sdlog, sdlogsex</span></span>
<span><span class="co">#&gt; SSD estimate methods (multivariate):</span></span>
<span><span class="co">#&gt;   GMsize, GMM</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean, arithmetic mean</span></span>
<span><span class="co">#&gt; Multivariate sampling with complete or missing data:</span></span>
<span><span class="co">#&gt;   complete</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method, multivariate method,</span></span>
<span><span class="co">#&gt;     centering algorithm, and complete or missing data structure: 18</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;   type of resampling: Monte Carlo</span></span>
<span><span class="co">#&gt;   number of resampled data sets: 5000</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 94</span></span>
<span><span class="co">#&gt;   proportion of missing data in resampling structure: 0</span></span>
<span><span class="co">#&gt;   resampling procedure: bootstrap</span></span>
<span><span class="co">#&gt;   subsamples sampled WITH replacement</span></span>
<span><span class="co">#&gt;   confidence intervals: two-sided, 95% confidence level</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     sex data present</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals for estimates:</span></span>
<span><span class="co">#&gt;    methodUni methodMulti  center datastructure proportionNA  lower_lim</span></span>
<span><span class="co">#&gt; 1        SSD      GMsize geomean      complete            0  0.2084850</span></span>
<span><span class="co">#&gt; 2        SSD         GMM geomean      complete            0  0.2084850</span></span>
<span><span class="co">#&gt; 3        MMR      GMsize geomean      complete            0  0.2081337</span></span>
<span><span class="co">#&gt; 4        MMR         GMM geomean      complete            0  0.2099397</span></span>
<span><span class="co">#&gt; 5        BDI      GMsize geomean      complete            0  0.1991350</span></span>
<span><span class="co">#&gt; 6        BDI         GMM geomean      complete            0  0.2049715</span></span>
<span><span class="co">#&gt; 7        ERM      GMsize geomean      complete            0  0.1689682</span></span>
<span><span class="co">#&gt; 8        ERM         GMM geomean      complete            0  0.1703679</span></span>
<span><span class="co">#&gt; 9        FMA      GMsize geomean      complete            0  0.1019914</span></span>
<span><span class="co">#&gt; 10       FMA         GMM geomean      complete            0  0.1265210</span></span>
<span><span class="co">#&gt; 11       MoM      GMsize geomean      complete            0  0.2079482</span></span>
<span><span class="co">#&gt; 12       MoM         GMM geomean      complete            0  0.1954272</span></span>
<span><span class="co">#&gt; 13       BFM      GMsize geomean      complete            0  0.2074400</span></span>
<span><span class="co">#&gt; 14       BFM         GMM geomean      complete            0  0.2044040</span></span>
<span><span class="co">#&gt; 15        CV      GMsize    mean      complete            0 11.3167618</span></span>
<span><span class="co">#&gt; 16     CVsex      GMsize    mean      complete            0 11.3840019</span></span>
<span><span class="co">#&gt; 17     sdlog      GMsize geomean      complete            0  0.1134311</span></span>
<span><span class="co">#&gt; 18  sdlogsex      GMsize geomean      complete            0  0.1141081</span></span>
<span><span class="co">#&gt;     upper_lim</span></span>
<span><span class="co">#&gt; 1   0.2457518</span></span>
<span><span class="co">#&gt; 2   0.2457518</span></span>
<span><span class="co">#&gt; 3   0.2455912</span></span>
<span><span class="co">#&gt; 4   0.2463640</span></span>
<span><span class="co">#&gt; 5   0.2376113</span></span>
<span><span class="co">#&gt; 6   0.2413813</span></span>
<span><span class="co">#&gt; 7   0.2149604</span></span>
<span><span class="co">#&gt; 8   0.2075787</span></span>
<span><span class="co">#&gt; 9   0.1106578</span></span>
<span><span class="co">#&gt; 10  0.1403489</span></span>
<span><span class="co">#&gt; 11  0.2487895</span></span>
<span><span class="co">#&gt; 12  0.2454951</span></span>
<span><span class="co">#&gt; 13  0.2455443</span></span>
<span><span class="co">#&gt; 14  0.2451287</span></span>
<span><span class="co">#&gt; 15 13.0268716</span></span>
<span><span class="co">#&gt; 16 13.0431259</span></span>
<span><span class="co">#&gt; 17  0.1304401</span></span>
<span><span class="co">#&gt; 18  0.1310351</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals for bias of estimates from sample SSD, CVsex, or sdlogsex:</span></span>
<span><span class="co">#&gt;    methodUni methodMulti  center datastructure proportionNA    lower_lim</span></span>
<span><span class="co">#&gt; 1        MMR      GMsize geomean      complete            0 -0.002211789</span></span>
<span><span class="co">#&gt; 2        MMR         GMM geomean      complete            0 -0.002465676</span></span>
<span><span class="co">#&gt; 3        BDI      GMsize geomean      complete            0 -0.020827670</span></span>
<span><span class="co">#&gt; 4        BDI         GMM geomean      complete            0 -0.013628009</span></span>
<span><span class="co">#&gt; 5        ERM      GMsize geomean      complete            0 -0.046912314</span></span>
<span><span class="co">#&gt; 6        ERM         GMM geomean      complete            0 -0.046525349</span></span>
<span><span class="co">#&gt; 7        FMA      GMsize geomean      complete            0 -0.137043889</span></span>
<span><span class="co">#&gt; 8        FMA         GMM geomean      complete            0 -0.110318964</span></span>
<span><span class="co">#&gt; 9        MoM      GMsize geomean      complete            0 -0.007488963</span></span>
<span><span class="co">#&gt; 10       MoM         GMM geomean      complete            0 -0.023224699</span></span>
<span><span class="co">#&gt; 11       BFM      GMsize geomean      complete            0 -0.001508778</span></span>
<span><span class="co">#&gt; 12       BFM         GMM geomean      complete            0 -0.007148997</span></span>
<span><span class="co">#&gt; 13        CV      GMsize    mean      complete            0 -0.481004727</span></span>
<span><span class="co">#&gt; 14     sdlog      GMsize geomean      complete            0 -0.002765170</span></span>
<span><span class="co">#&gt;        upper_lim</span></span>
<span><span class="co">#&gt; 1   0.000000e+00</span></span>
<span><span class="co">#&gt; 2   3.004033e-03</span></span>
<span><span class="co">#&gt; 3  -3.430143e-03</span></span>
<span><span class="co">#&gt; 4   5.267315e-04</span></span>
<span><span class="co">#&gt; 5  -2.436725e-02</span></span>
<span><span class="co">#&gt; 6  -3.357533e-02</span></span>
<span><span class="co">#&gt; 7  -1.009368e-01</span></span>
<span><span class="co">#&gt; 8  -7.561790e-02</span></span>
<span><span class="co">#&gt; 9   5.647615e-03</span></span>
<span><span class="co">#&gt; 10  4.538316e-03</span></span>
<span><span class="co">#&gt; 11 -4.367599e-05</span></span>
<span><span class="co">#&gt; 12  8.833804e-03</span></span>
<span><span class="co">#&gt; 13  9.807039e-02</span></span>
<span><span class="co">#&gt; 14  0.000000e+00</span></span></code></pre></div>
<p>Just as we saw above, it reports the number of specimens, the number
of variables and their names, and the univariate methods and centering
algorithms. It also reports the multivariate methods used and notes
whether multivariate sampling used complete or missing data. This will
always be “complete” for <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, but as we’ll see
later, <code><a href="../reference/SSDtest.html">SSDtest()</a></code> can be based on complete or missing data
patterns. In addition, the number of unique combinations of univariate
methods, multivariate methods, centering algorithms, and complete or
missing data structures is reported. A new piece of information is also
reported for the resampling data structure: the proportion of missing
data in that structure. This will always be zero for
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, but not necessarily for
<code><a href="../reference/SSDtest.html">SSDtest()</a></code>.</p>
<p>The tables giving the confidence limits are much the same as those
for univariate estimates, although they now include the additional
information about multivariate method, data structure, and proportion of
missing data. Just like in the univariate case, we can use
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> to pull out those data frames.</p>
</div>
<div class="section level4">
<h4 id="structure-of-the-object-1">Structure of the object<a class="anchor" aria-label="anchor" href="#structure-of-the-object-1"></a>
</h4>
<p>In the multivariate case, <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> produces an
object of class <code>dimorphResampledMulti</code>. The object structure
is essentially the same as in the univariate case, extended slightly to
capture information about the multivariate methods and record the
original multivariate data set.</p>
</div>
<div class="section level4">
<h4 id="plotting-1">Plotting<a class="anchor" aria-label="anchor" href="#plotting-1"></a>
</h4>
<p>Just as we saw with univariate bootstrapped confidence intervals,
visualizing the bootstrapped distributions is straightforward using
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsMgor</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-50-1.png" width="672"></p>
<p>And just like in the univariate examples, we can also exclude
specified univariate methods using <code>exclude</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsMgor</span>, exclude<span class="op">=</span><span class="st">"FMA"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-51-1.png" width="672"></p>
<p>We can also exclude multivariate methods from the plot using
<code>excludeMulti</code>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsMgor</span>, exclude<span class="op">=</span><span class="st">"FMA"</span>, excludeMulti<span class="op">=</span><span class="st">"GMsize"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-52-1.png" width="672"></p>
<p>And we can also plot bias from sex-based sample values, just like in
the univariate example.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bootsMgor</span>, type<span class="op">=</span><span class="st">"bias"</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-53-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="confidence-intervals-for-data-sets-with-missing-data">Confidence intervals for data sets with missing data?<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-data-sets-with-missing-data"></a>
</h3>
<p>Nope.</p>
<p>The function <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> won’t allow users to generate
bootstrapped confidence intervals for estimates based on missing data.
That said, <code><a href="../reference/resampleSSD.html">resampleSSD()</a></code>, the resampling function that
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> and <code><a href="../reference/SSDtest.html">SSDtest()</a></code> both rely on, has
great flexibility in how resampling procedures proceed. It is possible
to use that function to set up a bootstrap based on missing data, but
interpreting those confidence intervals would be quite tricky. When
there is missing data, any estimates (and confidence intervals around
them) are only meaningful in comparison to estimates from other samples
in which the data set has that same particular pattern of
missingness.</p>
<p>So with samples that have missing data, it’s most appropriate to run
a significance test for pairs of taxa where all taxon data sets are
resampled to the same sample size and missing data pattern.
<code><a href="../reference/SSDtest.html">SSDtest()</a></code> does exactly that.</p>
</div>
</div>
<div class="section level2">
<h2 id="running-signficance-tests-with-ssdtest">Running signficance tests with <code>SSDtest()</code><a class="anchor" aria-label="anchor" href="#running-signficance-tests-with-ssdtest"></a>
</h2>
<p>The function <code><a href="../reference/SSDtest.html">SSDtest()</a></code> allows users to run a variety of
resampling-based significance tests as commonly used in the
paleoanthropological literature. In particular, it allows for resampling
tests based on exact or Monte Carlo resampling techniques, sampling with
or without replacement, and using either univariate or multivariate
samples which may or may not have missing data.</p>
<div class="section level3">
<h3 id="univariate-estimates-1">Univariate estimates<a class="anchor" aria-label="anchor" href="#univariate-estimates-1"></a>
</h3>
<p>Significance tests comparing dimorphism for a single variable in a
fossil sample to dimorphism in extant comparative taxa typically
resample the extant samples down to the sample size of the fossil sample
(either with or without replacement), then compare the point estimate
calculated for the fossil sample to resampled distributions for the
comparative samples to generate one- or two-sided p-values (see studies
cited in Gordon 2025a for examples). Those procedures (and more) are
implemented in <code><a href="../reference/SSDtest.html">SSDtest()</a></code>.</p>
<div class="section level4">
<h4 id="using-ssdtest-with-one-fossil-sample-univariate">Using <code>SSDtest()</code> with one fossil sample
(univariate)<a class="anchor" aria-label="anchor" href="#using-ssdtest-with-one-fossil-sample-univariate"></a>
</h4>
<p>To run the procedures described above, <code><a href="../reference/SSDtest.html">SSDtest()</a></code>
requires the data sets as two separate arguments: <code>fossil</code>,
which is a list where each element is a data set for a single fossil
taxon (this will only have one element in this case), and
<code>comp</code>, a list where each element is a data set for a single
comparative taxon. Names for each list element are not required, but
providing them will make interpreting the results easier (those names
will be passed to the resulting object and will show up in summaries and
plots). Similarly, sex information is provided as separate lists for the
arguments <code>fossilsex</code> (which will typically be
<code>NULL</code>) and <code>compsex</code>.</p>
<p>Note that the following univariate example resamples from comparative
samples <strong>without</strong> replacement, which is the default
behavior of <code><a href="../reference/SSDtest.html">SSDtest()</a></code>. However, if users prefer to sample
<strong>with</strong> replacement they can simply set the argument
<code>replace</code> equal to <code>TRUE</code>. Any fossil specimen
without data for the variable is removed from the sample (this happens
regardless of the value of <code>na.rm</code>).</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_uni</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SSDtest.html">SSDtest</a></span><span class="op">(</span></span>
<span>     fossil<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A. afarensis"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. afarensis"</span>, <span class="st">"FEMHEAD"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     comp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"FEMHEAD"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"FEMHEAD"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>               <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"FEMHEAD"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     fossilsex<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     compsex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"Sex"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SSD"</span>, <span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span>
<span>     nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in dimorph::getsampleaddresses(comparative = comp[[i]], struc = struct,</span></span>
<span><span class="co">#&gt; : The number of possible combinations (194580) exceeds the user-specified</span></span>
<span><span class="co">#&gt; limit. Monte Carlo sampling will be used.</span></span>
<span><span class="co">#&gt; Warning in dimorph::getsampleaddresses(comparative = comp[[i]], struc = struct,</span></span>
<span><span class="co">#&gt; : The number of possible combinations (194580) exceeds the user-specified</span></span>
<span><span class="co">#&gt; limit. Monte Carlo sampling will be used.</span></span>
<span><span class="co">#&gt; Warning in dimorph::getsampleaddresses(comparative = comp[[i]], struc = struct,</span></span>
<span><span class="co">#&gt; : The number of possible combinations (194580) exceeds the user-specified</span></span>
<span><span class="co">#&gt; limit. Monte Carlo sampling will be used.</span></span>
<span><span class="co">#&gt; Warning in SSDtest(fossil = list(`A. afarensis` = GordonAJBA[GordonAJBA$Species == : The following comparisons contain NAs that were</span></span>
<span><span class="co">#&gt; dropped in the calculation of p-values:</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - H. sapiens</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - H. sapiens</span></span></code></pre></div>
<p>By default, <code><a href="../reference/SSDtest.html">SSDtest()</a></code> will attempt to perform exact
resampling for all of the comparative samples (argument
<code>exactcomp = TRUE</code>). If the number of unique combinations of
resampled data sets for a comparative taxon exceeds <code>limit</code>
(which defaults to 50,000), then Monte Carlo resampling will be used
instead with a number of iterations equal to <code>nResamp</code> (users
can also specify Monte Carlo sampling by setting
<code>exactcomp = FALSE</code>). The first set of warnings reported
above tell the user that sampling was switched to Monte Carlo for all
three comparative samples.</p>
<p>Also, because the fossil sample size is so small, sometimes when a
comparative sample is downsampled to the fossil sample size there is
only one sex present. In those cases <code>"SSD"</code>,
<code>"CVsex"</code>, and <code>"sdlogsex"</code> can’t be calculated
those methods require both sexes to be present in a sample in order to
be calculated. In any scenario where NAs are produced in at least one
iteration for a particular method in a particular sample, a warning is
generated to let the user know that p-values involving those
sample/method combinations drop the NA estimates before calculating
p-values. Users may or may not find those p-values acceptable. In any
event, tests using methods that require sex information for all
specimens typically won’t be usable for fossil samples since those
samples almost always lack sex information.</p>
</div>
<div class="section level4">
<h4 id="viewing-the-resulting-object-2">Viewing the resulting object<a class="anchor" aria-label="anchor" href="#viewing-the-resulting-object-2"></a>
</h4>
<p>Now let’s take a look at the output.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_uni</span></span>
<span><span class="co">#&gt;         SSDtest Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;          sample n female n male n unspecified</span></span>
<span><span class="co">#&gt;    A. afarensis        0      0             4</span></span>
<span><span class="co">#&gt;      G. gorilla       24     24             0</span></span>
<span><span class="co">#&gt;      H. sapiens       24     24             0</span></span>
<span><span class="co">#&gt;  P. troglodytes       24     24             0</span></span>
<span><span class="co">#&gt;   number of variables: 1</span></span>
<span><span class="co">#&gt;   variable names: FEMHEAD</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   SSD, MMR, BDI</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method and centering algorithm: 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;          sample n resampled data sets resampling type            sampling</span></span>
<span><span class="co">#&gt;    A. afarensis                     1           exact without replacement</span></span>
<span><span class="co">#&gt;      G. gorilla                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;      H. sapiens                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;  P. troglodytes                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 4</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median resampled estimates for each combination of methods:</span></span>
<span><span class="co">#&gt;   methodUni  center A. afarensis G. gorilla H. sapiens P. troglodytes</span></span>
<span><span class="co">#&gt; 1       SSD geomean           NA     0.2125     0.1268         0.0459</span></span>
<span><span class="co">#&gt; 2       MMR geomean       0.2393     0.1991     0.1261         0.0881</span></span>
<span><span class="co">#&gt; 3       BDI geomean       0.2322     0.1723     0.1114         0.0789</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (one-sided; null: first sample less or equally dimorphic as second sample):</span></span>
<span><span class="co">#&gt;                               SSD:geomean MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla              NA      0.2680      0.1114</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens              NA      0.0306      0.0064</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes          NA      0.0068      0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens            0.1422      0.2186      0.2139</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes        0.0276      0.1135      0.1069</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes        0.1652      0.2973      0.2904</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis              NA      0.7320      0.8886</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis              NA      0.9694      0.9936</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis          NA      0.9932      1.0000</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla            0.8578      0.7814      0.7861</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla        0.9724      0.8865      0.8931</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens        0.8348      0.7027      0.7096</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (two-sided):</span></span>
<span><span class="co">#&gt;                               SSD:geomean MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla              NA      0.5290      0.2472</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens              NA      0.0328      0.0064</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes          NA      0.0068      0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens            0.2853      0.4426      0.4342</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes        0.0492      0.2157      0.1957</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes        0.3310      0.5983      0.5857</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Warning: The following comparisons contain NAs that were</span></span>
<span><span class="co">#&gt; dropped in the calculation of p-values:</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - H. sapiens</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - H. sapiens</span></span></code></pre></div>
<p>To begin with, we’ve got information about the data set. First, the
sample size broken out by sex for each sample, then the number of
variables and the names of those variables are provided (if those names
were in the data set given to <code><a href="../reference/SSDtest.html">SSDtest()</a></code>). There’s also
information about the estimation method(s) used and the centering
algorithm(s) used, along with number of unique combinations of methods
and centering algorithms.</p>
<p>Next there’s information about the resampling data structure, with
the number of resampled datasets given for each sample and the type of
sampling used. Because this procedure downsamples all samples to the
size of the fossil sample without replacement, there is only one
resampled fossil data set (which is the original fossil data set). Even
when <code>replace=TRUE</code>, only the comparative data sets are
sampled with replacement, not the fossil sample (refer to the help page
for <code><a href="../reference/SSDtest.html">SSDtest()</a></code> for information about resampling both the
comparative and fossil samples). Also reported is the number of
individuals in each resampled data set, as well as any other information
about the resampling procedure.</p>
<p>The next section of printed information provides the median resampled
value for each sample and each method. Alternatively, the mean resampled
value can be reported by using
<code>print(test_fossil_uni, central="mean")</code>.</p>
<p>The remainder of the reported information relates to calculated
p-values for all pairwise comparisons of two samples. First one-sided
p-values are reported for both directions, then two-sided p-values (see
Gordon 2025a for details of their calculation). If any p-values are
based on sets of estimates that include NAs, a warning is given that
identifies the p-values for which that is the case.</p>
</div>
<div class="section level4">
<h4 id="structure-of-the-object-2">Structure of the object<a class="anchor" aria-label="anchor" href="#structure-of-the-object-2"></a>
</h4>
<p><code><a href="../reference/SSDtest.html">SSDtest()</a></code> produces an object of class
<code>SSDtest</code>. This is a more complex object than the
<code>dimorphResampledUni</code> object produced by
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> applied to univariate data. In fact, the
<code>SSDtest</code> object contains multiple
<code>dimorphResampledUni</code> objects, one for each taxon sample, as
well as other information. Let’s take a look.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "estimates"  "methcombos" "pvalues"</span></span></code></pre></div>
<p>The <code>SSDtest</code> object is a list containing three
components: <code>estimates</code>, <code>methcombos</code>, and
<code>pvalues</code>. <code>methcombos</code> is a data frame containing
means and medians for each taxon sample for each combination of methods,
and <code>pvalues</code> is a list containing two matrices of one-sided
and two-sided p-values.</p>
<p>We can use a couple of functions to extract data frames from the
<code>methcombos</code> and <code>pvalues</code> elements of a
<code>SSDtest</code> object: <code>centers()</code> and
<code>pvals()</code>. <code>centers()</code> provides a data frame with
mean and median resampled values for every sample for each method
combination.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">centers</span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">)</span></span>
<span><span class="co">#&gt;   methodUni  center median.A. afarensis mean.A. afarensis median.G. gorilla</span></span>
<span><span class="co">#&gt; 1       SSD geomean                  NA                NA         0.2124633</span></span>
<span><span class="co">#&gt; 2       MMR geomean           0.2392566         0.2392566         0.1990785</span></span>
<span><span class="co">#&gt; 3       BDI geomean           0.2322377         0.2322377         0.1722730</span></span>
<span><span class="co">#&gt;   mean.G. gorilla median.H. sapiens mean.H. sapiens median.P. troglodytes</span></span>
<span><span class="co">#&gt; 1       0.2140611         0.1267858       0.1279168            0.04590631</span></span>
<span><span class="co">#&gt; 2       0.1962144         0.1260593       0.1297642            0.08808577</span></span>
<span><span class="co">#&gt; 3       0.1684665         0.1114163       0.1138409            0.07886737</span></span>
<span><span class="co">#&gt;   mean.P. troglodytes</span></span>
<span><span class="co">#&gt; 1          0.04885744</span></span>
<span><span class="co">#&gt; 2          0.09533623</span></span>
<span><span class="co">#&gt; 3          0.08393418</span></span></code></pre></div>
<p><code>pvals()</code> pulls out one of the p-value data frames, and
the argument <code>alternative</code> has two options:
<code>"two.sided"</code> (the default) and <code>"one.sided"</code>.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pvals</span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in pvals(test_fossil_uni): The following comparisons contain NAs that were</span></span>
<span><span class="co">#&gt; dropped in the calculation of p-values:</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - H. sapiens</span></span>
<span><span class="co">#&gt;   SSD:geomean: G. gorilla - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - P. troglodytes</span></span>
<span><span class="co">#&gt;   SSD:geomean: H. sapiens - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - G. gorilla</span></span>
<span><span class="co">#&gt;   SSD:geomean: P. troglodytes - H. sapiens</span></span>
<span><span class="co">#&gt;                                   SSD:geomean MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; H0: A. afarensis = G. gorilla              NA   0.5290000   0.2472000</span></span>
<span><span class="co">#&gt; H0: A. afarensis = H. sapiens              NA   0.0328000   0.0064000</span></span>
<span><span class="co">#&gt; H0: A. afarensis = P. troglodytes          NA   0.0068000   0.0000000</span></span>
<span><span class="co">#&gt; H0: G. gorilla = H. sapiens        0.28530542   0.4425884   0.4342208</span></span>
<span><span class="co">#&gt; H0: G. gorilla = P. troglodytes    0.04922726   0.2156509   0.1956675</span></span>
<span><span class="co">#&gt; H0: H. sapiens = P. troglodytes    0.33099415   0.5982979   0.5857246</span></span></code></pre></div>
<p><code>pvals()</code> returns the data frame, but it also generates
the same warning we saw earlier. We can suppress that warning if we want
to.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu">pvals</span><span class="op">(</span><span class="va">test_fossil_uni</span>, alternative<span class="op">=</span><span class="st">"one.sided"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                    SSD:geomean MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; H0: A. afarensis &lt;= G. gorilla              NA   0.2680000   0.1114000</span></span>
<span><span class="co">#&gt; H0: A. afarensis &lt;= H. sapiens              NA   0.0306000   0.0064000</span></span>
<span><span class="co">#&gt; H0: A. afarensis &lt;= P. troglodytes          NA   0.0068000   0.0000000</span></span>
<span><span class="co">#&gt; H0: G. gorilla &lt;= H. sapiens        0.14221337   0.2186031   0.2139227</span></span>
<span><span class="co">#&gt; H0: G. gorilla &lt;= P. troglodytes    0.02757475   0.1135224   0.1068574</span></span>
<span><span class="co">#&gt; H0: H. sapiens &lt;= P. troglodytes    0.16519551   0.2973175   0.2903688</span></span>
<span><span class="co">#&gt; H0: G. gorilla &lt;= A. afarensis              NA   0.7320000   0.8886000</span></span>
<span><span class="co">#&gt; H0: H. sapiens &lt;= A. afarensis              NA   0.9694000   0.9936000</span></span>
<span><span class="co">#&gt; H0: P. troglodytes &lt;= A. afarensis          NA   0.9932000   1.0000000</span></span>
<span><span class="co">#&gt; H0: H. sapiens &lt;= G. gorilla        0.85778663   0.7813969   0.7860773</span></span>
<span><span class="co">#&gt; H0: P. troglodytes &lt;= G. gorilla    0.97242525   0.8864776   0.8931426</span></span>
<span><span class="co">#&gt; H0: P. troglodytes &lt;= H. sapiens    0.83480449   0.7026825   0.7096312</span></span></code></pre></div>
<p>The remaining element of a <code>SSDtest</code> object,
<code>estimates</code>, is a list containing elements corresponding to
each taxon sample:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">$</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A. afarensis"   "G. gorilla"     "H. sapiens"     "P. troglodytes"</span></span></code></pre></div>
<p>These list components are all objects of class
<code>dimorphResampledUni</code>, which is the same class produced by
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> applied to univariate datasets (both
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code> and <code><a href="../reference/SSDtest.html">SSDtest()</a></code> call on
<code><a href="../reference/resampleSSD.html">resampleSSD()</a></code>, which generates these objects). Just like
the objects produced by <code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, these objects
contain all of the resampled estimates; a summary of the information
contained in them can be generated by typing their names. Here’s that
information for the fossil sample:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_uni</span><span class="op">$</span><span class="va">estimates</span><span class="op">[[</span><span class="st">"A. afarensis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;         dimorphResampledUni Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;   number of specimens: 4 (sex unspecified)</span></span>
<span><span class="co">#&gt;   number of variables: 1</span></span>
<span><span class="co">#&gt;   variable name: FEMHEAD</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   MMR, BDI</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method and centering algorithm: 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;   type of resampling: exact</span></span>
<span><span class="co">#&gt;   number of resampled data sets: 1</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 4</span></span>
<span><span class="co">#&gt;   subsamples sampled WITHOUT replacement</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     sex data absent</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span></code></pre></div>
<p>And here’s the information for one of the comparative samples:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_uni</span><span class="op">$</span><span class="va">estimates</span><span class="op">[[</span><span class="st">"G. gorilla"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;         dimorphResampledUni Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;   number of specimens: 24 female, 24 male</span></span>
<span><span class="co">#&gt;   number of variables: 1</span></span>
<span><span class="co">#&gt;   variable name: FEMHEAD</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   SSD, MMR, BDI</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method and centering algorithm: 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;   type of resampling: Monte Carlo</span></span>
<span><span class="co">#&gt;   number of resampled data sets: 5000</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 4</span></span>
<span><span class="co">#&gt;   subsamples sampled WITHOUT replacement</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     sex data present</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span></code></pre></div>
<p>Because these parts of the <code>SSDtest</code> object are
<code>dimorphResampledUni</code> objects just like the output of
<code><a href="../reference/bootdimorph.html">bootdimorph()</a></code>, we can plot them if we want to:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">$</span><span class="va">estimates</span><span class="op">[[</span><span class="st">"G. gorilla"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-64-1.png" width="672"></p>
<p>Notice that no confidence intervals are drawn - that’s because this
object doesn’t have any. Now let’s look into plotting the whole
<code>SSDtest</code> object.</p>
</div>
<div class="section level4">
<h4 id="plotting-2">Plotting<a class="anchor" aria-label="anchor" href="#plotting-2"></a>
</h4>
<p>There are a number of different ways the information in a
<code>SSDtest</code> object can be visualized (type
<code><a href="../reference/plot.SSDtest.html">help(plot.SSDtest)</a></code> for detailed information). Simply using
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> with no other arguments will plot histograms of the
resampled distributions for all taxon samples for the first combination
of univariate and multivariate methods.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span><span class="op">)</span></span></code></pre></div>
<p>Note that the fossil sample is not included here. That’s because the
first method combination is plotted by default; in this case, that’s
<code>"SSD"</code> using the <code>"geomean"</code> centering algorithm,
and that can’t be calculated for samples without sex information.</p>
<p>We can change what’s plotted by using the argument <code>est</code>
to denote the estimate method combination we want. If we refer back to
the printed output of <code>test_fossil_uni</code> above, we see that
the second method combination generates resampled values of
<code>"MMR"</code> using the <code>"geomean"</code> centering algorithm,
and it includes the observed value for the fossil sample. Let’s plot
that.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span>, est<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># plots second method (MMR)</span></span></code></pre></div>
<p>The fossil sample is included as a vertical line because it’s a
single point estimate and is not resampled.</p>
<p>We also might want to adjust the colors for each resampled
distribution. We can do that by using the argument
<code>groupcols</code>, specifying a vector of colors with names for
each element corresponding to the taxon sample names.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">speciescolors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A. afarensis"</span><span class="op">=</span><span class="st">"#352A87"</span>, <span class="st">"A. africanus"</span><span class="op">=</span><span class="st">"#F9FB0E"</span>, <span class="st">"G. gorilla"</span><span class="op">=</span><span class="st">"#EABA4B"</span>,</span>
<span>                   <span class="st">"H. sapiens"</span><span class="op">=</span><span class="st">"#09A9C0"</span>, <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="st">"#78BE7C"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span>, est<span class="op">=</span><span class="fl">2</span>, groupcols<span class="op">=</span><span class="va">speciescolors</span><span class="op">)</span> <span class="co"># change the colors</span></span></code></pre></div>
<p>We might further want to visualize the resampled difference in
estimates for any given pair of samples. We can do this by setting the
argument <code>type</code> to <code>"diff"</code> (the default is
<code>"est"</code>). By default, this will produce histograms for all
pairwise combinations of samples, which are generated by calculating the
difference between all possible pairs of one value from each of the two
resampled distributions. That calculation is performed at the time of
plotting so these plots may take a long time to generate if a large
number of iterations was used by <code><a href="../reference/SSDtest.html">SSDtest()</a></code>.</p>
<p>By default, these histograms are plotted in a single grid of plots.
However, we’ll plot them individually here to keep them legible using
the arguments <code>gridplot</code> and <code>useradvance</code>.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span>, est<span class="op">=</span><span class="fl">2</span>, type<span class="op">=</span><span class="st">"diff"</span>, <span class="co"># plots differences for all pairs of samples</span></span>
<span>     gridplot<span class="op">=</span><span class="cn">FALSE</span>, useradvance<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># prints each plot separately without waiting for user input</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-68-1.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-68-2.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-68-3.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-68-4.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-68-5.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-68-6.png" width="672"></p>
<p>Alternatively, we might want to plot the difference for a single pair
of samples. In that case, a vector of two integers specifying the
samples to include is passed to the argument <code>diffs</code>. These
integers are the order in which the samples were given to
<code><a href="../reference/SSDtest.html">SSDtest()</a></code>, and are the order that the samples appear in
when the <code>SSDtest</code> object is printed.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_uni</span>, type<span class="op">=</span><span class="st">"diff"</span>, est<span class="op">=</span><span class="fl">2</span>, diffs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># plots diffs between first pair of samples</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-69-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="using-ssdtest-with-multiple-fossil-samples-univariate">Using <code>SSDtest()</code> with multiple fossil samples
(univariate)<a class="anchor" aria-label="anchor" href="#using-ssdtest-with-multiple-fossil-samples-univariate"></a>
</h4>
<p>We can also include more than one fossil sample in univariate tests,
in which case any fossil samples larger than the smallest fossil sample
will also be resampled down to the sample size of the smallest fossil
sample. Because we know that the number of unique combinations of
resampled data sets for our comparative samples far exceeds
<code>limit</code>, we can specify that we want to use Monte Carlo
resampling for them by setting <code>exactcomp=FALSE</code>. By default,
<code><a href="../reference/SSDtest.html">SSDtest()</a></code> will also attempt to perform exact resampling for
all of the fossil samples (argument <code>exactfossil = TRUE</code>),
switching to Monte Carlo resampling if the number of unique combinations
of resampled data sets for a fossil taxon exceeds
<code>limit</code>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_2fossil_uni</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SSDtest.html">SSDtest</a></span><span class="op">(</span></span>
<span>     fossil<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A. afarensis"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. afarensis"</span>, <span class="st">"FEMHEAD"</span><span class="op">]</span>,</span>
<span>                   <span class="st">"A. africanus"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. africanus"</span>, <span class="st">"FEMHEAD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     comp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"FEMHEAD"</span><span class="op">]</span>,</span>
<span>               <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"FEMHEAD"</span><span class="op">]</span>,</span>
<span>               <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"FEMHEAD"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     fossilsex<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     compsex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"Sex"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span>
<span>     exactcomp<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>     nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span></code></pre></div>
<p>As with the one fossil sample case we can print the output.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_2fossil_uni</span></span>
<span><span class="co">#&gt;         SSDtest Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;          sample n female n male n unspecified</span></span>
<span><span class="co">#&gt;    A. afarensis        0      0             4</span></span>
<span><span class="co">#&gt;    A. africanus        0      0            13</span></span>
<span><span class="co">#&gt;      G. gorilla       24     24             0</span></span>
<span><span class="co">#&gt;      H. sapiens       24     24             0</span></span>
<span><span class="co">#&gt;  P. troglodytes       24     24             0</span></span>
<span><span class="co">#&gt;   number of variables: 1</span></span>
<span><span class="co">#&gt;   variable names: VAR</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   MMR, BDI</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method and centering algorithm: 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;          sample n resampled data sets resampling type            sampling</span></span>
<span><span class="co">#&gt;    A. afarensis                     1           exact without replacement</span></span>
<span><span class="co">#&gt;    A. africanus                   715           exact without replacement</span></span>
<span><span class="co">#&gt;      G. gorilla                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;      H. sapiens                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;  P. troglodytes                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 4</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median resampled estimates for each combination of methods:</span></span>
<span><span class="co">#&gt;   methodUni  center A. afarensis A. africanus G. gorilla H. sapiens</span></span>
<span><span class="co">#&gt; 1       MMR geomean       0.2393       0.1179     0.1978     0.1249</span></span>
<span><span class="co">#&gt; 2       BDI geomean       0.2322       0.1063     0.1717     0.1108</span></span>
<span><span class="co">#&gt;   P. troglodytes</span></span>
<span><span class="co">#&gt; 1         0.0895</span></span>
<span><span class="co">#&gt; 2         0.0803</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (one-sided; null: first sample less or equally dimorphic as second sample):</span></span>
<span><span class="co">#&gt;                               MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus        0.0112      0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla          0.2700      0.1126</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens          0.0294      0.0070</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes      0.0072      0.0004</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla          0.8036      0.7983</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens          0.5271      0.5184</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes      0.3290      0.3251</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens            0.2193      0.2141</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes        0.1191      0.1131</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes        0.3089      0.3055</span></span>
<span><span class="co">#&gt; A. africanus - A. afarensis        0.9888      1.0000</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis          0.7300      0.8874</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis          0.9706      0.9930</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis      0.9928      0.9996</span></span>
<span><span class="co">#&gt; G. gorilla - A. africanus          0.1964      0.2017</span></span>
<span><span class="co">#&gt; H. sapiens - A. africanus          0.4729      0.4816</span></span>
<span><span class="co">#&gt; P. troglodytes - A. africanus      0.6710      0.6749</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla            0.7807      0.7859</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla        0.8809      0.8869</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens        0.6911      0.6945</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (two-sided):</span></span>
<span><span class="co">#&gt;                               MMR:geomean BDI:geomean</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus        0.0112      0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla          0.5282      0.2462</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens          0.0310      0.0070</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes      0.0072      0.0004</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla          0.3943      0.4076</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens          0.9367      0.9619</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes      0.6724      0.6568</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens            0.4450      0.4355</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes        0.2270      0.2094</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes        0.6222      0.6157</span></span></code></pre></div>
<p>We can also plot the output in the same way as we did earlier.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_uni</span>, est<span class="op">=</span><span class="fl">1</span>, groupcols<span class="op">=</span><span class="va">speciescolors</span><span class="op">)</span></span></code></pre></div>
<p>In this case we have a resampled distribution for one of the fossil
samples in addition to all of the comparative samples. If we want to
better distinguish overlapping distributions, we can give a vector of
one or more integer values to the argument <code>invert</code>. This
will flip the histograms of the corresponding sample(s) in the plot (and
move those sample names to the bottom of the legend).</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_uni</span>, invert<span class="op">=</span><span class="fl">2</span>, est<span class="op">=</span><span class="fl">1</span>, groupcols<span class="op">=</span><span class="va">speciescolors</span><span class="op">)</span></span></code></pre></div>
<p>And just as we did earlier, we can plot histograms for the difference
in estimates for pairs of samples.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_uni</span>, type<span class="op">=</span><span class="st">"diff"</span>, est<span class="op">=</span><span class="fl">2</span>, diffs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-75-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-estimates-1">Multivariate estimates<a class="anchor" aria-label="anchor" href="#multivariate-estimates-1"></a>
</h3>
<p>Finally, we can test for difference in multivariate dimorphism
between one or more fossil samples with missing data and one or more
complete comparative data sets. The procedures described below follow
those outlined in Gordon et al. (2008), Gordon (2025a), and Gordon
(2025b). Please refer to those articles for more specific details.</p>
<p>To begin with, let’s specify a vector containing the names of all of
the variables we’ll include in our data sets.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SSDvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HUMHEAD"</span>, <span class="st">"ELBOW0.5"</span>, <span class="st">"RADTV"</span>, <span class="st">"FEMHEAD"</span>,    </span>
<span>             <span class="st">"FEMSHAFT0.5"</span>, <span class="st">"DISTFEM0.5"</span>, <span class="st">"PROXTIB0.5"</span>, <span class="st">"DISTTIB0.5"</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s run some tests.</p>
<div class="section level4">
<h4 id="using-ssdtest-with-missing-data-in-one-fossil-sample-multivariate">Using <code>SSDtest()</code> with missing data in one fossil sample
(multivariate)<a class="anchor" aria-label="anchor" href="#using-ssdtest-with-missing-data-in-one-fossil-sample-multivariate"></a>
</h4>
<p>First, we’ll run <code><a href="../reference/SSDtest.html">SSDtest()</a></code> for the situation where we
have a single fossil sample with missing data that we’d like to compare
to one or more comparative samples with no missing data. As in the
univariate case, <code><a href="../reference/SSDtest.html">SSDtest()</a></code> attempts to perform exact
resampling for all of the comparative samples by default (argument
<code>exactcomp = TRUE</code>) but shifts to Monte Carlo resampling if
the number of unique resampled data sets exceeds <code>limit</code>.
We’ll set <code>exactcomp = FALSE</code> here to just use Monte Carlo
sampling from the outset.</p>
<p>The only multivariate method we’ll run here is <code>"GMM"</code>.
Remember, the <code>"GMM"</code> approach (and <code>"GMsize"</code>,
which can’t be used with incomplete data) generates estimates of
dimorphism for an overall size variable that is the geometric mean of
all of the included variables. These variables should all be of the same
dimensionality (linear, area, volume) and measured in the same units. If
we wanted to, we could also use the <code>"TM"</code> approach. Remember
that <code>"TM"</code> estimates dimorphism for a single variable (the
template variable) rather than an overall measure of size. Also,
remember that it’s highly flawed - <em>don’t use it!</em> (But if you
really, really want to, the function will allow you to do it. Just
remember that <code>"GMM"</code> and <code>"TM"</code> are estimating
dimorphism for different size variables.)</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SSDtest.html">SSDtest</a></span><span class="op">(</span></span>
<span>     fossil<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A. afarensis"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. afarensis"</span>, <span class="va">SSDvars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     comp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span>
<span>               <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span>
<span>               <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="va">SSDvars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     fossilsex<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     compsex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"Sex"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span>
<span>     methsMulti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span><span class="op">)</span>,</span>
<span>     exactcomp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     datastruc<span class="op">=</span><span class="st">"both"</span>,</span>
<span>     nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span></code></pre></div>
<p>Above we’ve specified that we’d like to estimate dimorphism using the
<code>"GMM"</code> multivariate method in conjunction with both the
<code>"MMR"</code> and <code>"BDI"</code> univariate methods. In
addition, the argument <code>datastruc</code> is set to
<code>"both"</code>. The other options are <code>"complete"</code> and
<code>"missing"</code>. When set to <code>"complete"</code>,
<code><a href="../reference/SSDtest.html">SSDtest()</a></code> downsamples the comparative samples to the size
of the fossil sample in every iteration of the resampling procedure,
then estimates dimorphism in the comparative samples using all of the
resampled data (i.e., not mimicking the missing data structure of the
fossil sample). Dimorphism is not estimated for the fossil sample when
<code>datastruc="complete"</code>. When it is <code>"missing"</code>,
the pattern of missing data in the fossil sample is imposed on the
resampled comparative datasets in each iteration (see Gordon et al.,
2008 and Gordon, 2025a for more detail). Dimorphism is also estimated
for the fossil sample as a single point estimate. When
<code>datastruc="both"</code>, <code><a href="../reference/SSDtest.html">SSDtest()</a></code> generates both
sets of estimates (and analyzes them separately).</p>
</div>
<div class="section level4">
<h4 id="viewing-the-resulting-object-3">Viewing the resulting object<a class="anchor" aria-label="anchor" href="#viewing-the-resulting-object-3"></a>
</h4>
<p>Now let’s take a look at the resulting object. It will look very
similar to the object produced in the univariate case with a few
additional pieces of information.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_fossil_multi</span></span>
<span><span class="co">#&gt;         SSDtest Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;          sample n female n male n unspecified</span></span>
<span><span class="co">#&gt;    A. afarensis        0      0            20</span></span>
<span><span class="co">#&gt;      G. gorilla       24     24             0</span></span>
<span><span class="co">#&gt;      H. sapiens       24     24             0</span></span>
<span><span class="co">#&gt;  P. troglodytes       24     24             0</span></span>
<span><span class="co">#&gt;   number of variables: 8</span></span>
<span><span class="co">#&gt;   variable names: HUMHEAD, ELBOW0.5, RADTV, FEMHEAD, FEMSHAFT0.5, DISTFEM0.5, PROXTIB0.5, DISTTIB0.5</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   MMR, BDI</span></span>
<span><span class="co">#&gt; SSD estimate methods (multivariate):</span></span>
<span><span class="co">#&gt;   GMM</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Multivariate sampling with complete or missing data:</span></span>
<span><span class="co">#&gt;   complete and missing</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method, multivariate method,</span></span>
<span><span class="co">#&gt;     centering algorithm, and complete or missing data structure: 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;          sample n resampled data sets resampling type            sampling</span></span>
<span><span class="co">#&gt;    A. afarensis                     1           exact without replacement</span></span>
<span><span class="co">#&gt;      G. gorilla                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;      H. sapiens                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;  P. troglodytes                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;   missing data resampling structure: </span></span>
<span><span class="co">#&gt;     sampling individuals, then imposing missing data pattern</span></span>
<span><span class="co">#&gt;   number of individuals in each resampled data set: 20</span></span>
<span><span class="co">#&gt;   proportion of missing data in resampling structure: 0.806</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median resampled estimates for each combination of methods:</span></span>
<span><span class="co">#&gt;   methodUni methodMulti  center datastructure A. afarensis G. gorilla</span></span>
<span><span class="co">#&gt; 1       MMR         GMM geomean      complete           NA     0.2299</span></span>
<span><span class="co">#&gt; 2       MMR         GMM geomean       missing       0.2476     0.1882</span></span>
<span><span class="co">#&gt; 3       BDI         GMM geomean      complete           NA     0.2135</span></span>
<span><span class="co">#&gt; 4       BDI         GMM geomean       missing       0.2311     0.1648</span></span>
<span><span class="co">#&gt;   H. sapiens P. troglodytes</span></span>
<span><span class="co">#&gt; 1     0.1387         0.1021</span></span>
<span><span class="co">#&gt; 2     0.1184         0.0881</span></span>
<span><span class="co">#&gt; 3     0.1348         0.1004</span></span>
<span><span class="co">#&gt; 4     0.1078         0.0809</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (one-sided; null: first sample less or equally dimorphic as second sample):</span></span>
<span><span class="co">#&gt;                               MMR:GMM:geomean:complete MMR:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0274</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0000                  0.0299</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0000                  0.0030</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0061                  0.1486</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis                           NA                  0.9726</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis                           NA                  1.0000</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis                       NA                  1.0000</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla                         1.0000                  0.9701</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla                     1.0000                  0.9970</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens                     0.9939                  0.8514</span></span>
<span><span class="co">#&gt;                               BDI:GMM:geomean:complete BDI:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0080</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0002                  0.0414</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0000                  0.0048</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0083                  0.1548</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis                           NA                  0.9920</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis                           NA                  1.0000</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis                       NA                  1.0000</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla                         0.9998                  0.9586</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla                     1.0000                  0.9952</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens                     0.9917                  0.8452</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (two-sided):</span></span>
<span><span class="co">#&gt;                               MMR:GMM:geomean:complete MMR:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0482</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0000                  0.0600</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0000                  0.0050</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0113                  0.2971</span></span>
<span><span class="co">#&gt;                               BDI:GMM:geomean:complete BDI:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0126</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0000</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0002                  0.0838</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0000                  0.0088</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0145                  0.3096</span></span></code></pre></div>
<p>There is some notable additional information beyond what we saw with
a univariate <code>SSDtest</code> object, especially in relation to the
resampling data structure. In that section, the missing data resampling
structure is reported. Here it says, “sampling individuals, then
imposing missing data pattern,” the process described above. In
addition, the proportion of missing data in the fossil sample - and thus
in the resampling structure - is also reported. However, a different
missing data resampling structure will be used when multiple fossil
samples with missing data are included (more on that below).</p>
</div>
<div class="section level4">
<h4 id="structure-of-the-object-3">Structure of the object<a class="anchor" aria-label="anchor" href="#structure-of-the-object-3"></a>
</h4>
<p>The structure of a <code>SSDtest</code> object produced by
multivariate data is essentially the same as that produced by univariate
data. The one difference is that it contains multiple
<code>dimorphResampledMulti</code> objects rather than
<code>dimorphResampledUni</code> objects. As before, we can plot those
objects if we want to.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_multi</span><span class="op">$</span><span class="va">estimates</span><span class="op">[[</span><span class="st">"G. gorilla"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-80-1.png" width="672"></p>
<p>In the above plot we can see the effect on the distributions of
resampled estimates of imposing the missing data structure onto the
comparative sample. Now let’s plot the whole <code>SSDtest</code>
object.</p>
</div>
<div class="section level4">
<h4 id="plotting-3">Plotting<a class="anchor" aria-label="anchor" href="#plotting-3"></a>
</h4>
<p>Plotting is exactly the same for multivariate significance tests as
it is for the univariate case. Using <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> generates
histograms for the resampled values using the first methods combination
in the <code>SSDtest</code> object.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_multi</span><span class="op">)</span></span></code></pre></div>
<p>Note that the x-axis label reports the univariate method, the
multivariate method as a subscript, and whether or not the missing data
structure was imposed in parentheses. This first method combination uses
complete data and does not impose the missing data pattern, so
dimorphism isn’t estimated for the fossil sample in this case. We can
take a look at the resampled distributions using the missing data
structure by changing the estimate that’s plotted (argument
<code>est</code>).</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_multi</span>, est<span class="op">=</span><span class="fl">2</span>, <span class="co"># plot the 2nd method combination: MMR, GMM, "missing" datastructure</span></span>
<span>     groupcols<span class="op">=</span><span class="va">speciescolors</span><span class="op">)</span> <span class="co"># use our previously specified color vector</span></span></code></pre></div>
<p>As in the univariate case, the distributions of differences in
resampled values can also be plotted.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_fossil_multi</span>, est<span class="op">=</span><span class="fl">2</span>, type<span class="op">=</span><span class="st">"diff"</span>,</span>
<span>     gridplot<span class="op">=</span><span class="cn">FALSE</span>, useradvance<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-83-1.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-83-2.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-83-3.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-83-4.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-83-5.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-83-6.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="using-ssdtest-with-missing-data-in-multiple-fossil-samples-multivariate">Using <code>SSDtest()</code> with missing data in multiple fossil
samples (multivariate)<a class="anchor" aria-label="anchor" href="#using-ssdtest-with-missing-data-in-multiple-fossil-samples-multivariate"></a>
</h4>
<p>Finally, we may want to include two or more fossil samples in the
same set of significance tests. In order to allow for direct comparison
of estimates across all fossil samples, the same missing data structure
must be imposed on all samples, fossil and comparative alike. This
follows the procedure developed in Gordon (2025b), which downsamples
within each variable to the sample size for that variable in the fossil
sample with the smallest sample for that particular variable. See Gordon
(2025b) for a more detailed explanation of this procedure.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_2fossil_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/SSDtest.html">SSDtest</a></span><span class="op">(</span></span>
<span>     fossil<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"A. afarensis"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. afarensis"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span>
<span>                 <span class="st">"A. africanus"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"A. africanus"</span>, <span class="va">SSDvars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     comp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span>
<span>               <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="va">SSDvars</span><span class="op">]</span>,</span>
<span>               <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="va">SSDvars</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     fossilsex<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>     compsex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"G. gorilla"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Gorilla gorilla"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"H. sapiens"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Homo sapiens"</span>, <span class="st">"Sex"</span><span class="op">]</span>,</span>
<span>                  <span class="st">"P. troglodytes"</span><span class="op">=</span><span class="va">GordonAJBA</span><span class="op">[</span><span class="va">GordonAJBA</span><span class="op">$</span><span class="va">Species</span><span class="op">==</span><span class="st">"Pan troglodytes"</span>, <span class="st">"Sex"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     methsUni<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MMR"</span>, <span class="st">"BDI"</span><span class="op">)</span>,</span>
<span>     methsMulti<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GMM"</span><span class="op">)</span>,</span>
<span>     exactcomp <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>     exactfossil <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>     datastruc<span class="op">=</span><span class="st">"both"</span>,</span>
<span>     nResamp<span class="op">=</span><span class="va">nResample</span><span class="op">)</span></span></code></pre></div>
<p>Let’s take a look at <code>test_2fossil_multi</code>.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_2fossil_multi</span></span>
<span><span class="co">#&gt;         SSDtest Object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparative data set:</span></span>
<span><span class="co">#&gt;          sample n female n male n unspecified</span></span>
<span><span class="co">#&gt;    A. afarensis        0      0            15</span></span>
<span><span class="co">#&gt;    A. africanus        0      0            24</span></span>
<span><span class="co">#&gt;      G. gorilla       24     24             0</span></span>
<span><span class="co">#&gt;      H. sapiens       24     24             0</span></span>
<span><span class="co">#&gt;  P. troglodytes       24     24             0</span></span>
<span><span class="co">#&gt;   number of variables: 6</span></span>
<span><span class="co">#&gt;   variable names: HUMHEAD, RADTV, FEMHEAD, FEMSHAFT0.5, DISTFEM0.5, DISTTIB0.5</span></span>
<span><span class="co">#&gt; SSD estimate methods (univariate):</span></span>
<span><span class="co">#&gt;   MMR, BDI</span></span>
<span><span class="co">#&gt; SSD estimate methods (multivariate):</span></span>
<span><span class="co">#&gt;   GMM</span></span>
<span><span class="co">#&gt; Centering algorithms:</span></span>
<span><span class="co">#&gt;   geometric mean</span></span>
<span><span class="co">#&gt; Multivariate sampling with complete or missing data:</span></span>
<span><span class="co">#&gt;   complete and missing</span></span>
<span><span class="co">#&gt; Number of unique combinations of univariate method, multivariate method,</span></span>
<span><span class="co">#&gt;     centering algorithm, and complete or missing data structure: 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Resampling data structure:</span></span>
<span><span class="co">#&gt;          sample n resampled data sets resampling type            sampling</span></span>
<span><span class="co">#&gt;    A. afarensis                   336           exact without replacement</span></span>
<span><span class="co">#&gt;    A. africanus                 12870           exact without replacement</span></span>
<span><span class="co">#&gt;      G. gorilla                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;      H. sapiens                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;  P. troglodytes                  5000     Monte Carlo without replacement</span></span>
<span><span class="co">#&gt;   missing data resampling structure: </span></span>
<span><span class="co">#&gt;     sampling variable-specific number of individuals for each variable</span></span>
<span><span class="co">#&gt;   number of resampled individuals by variable in each resampled data set:</span></span>
<span><span class="co">#&gt;     HUMHEAD: 2</span></span>
<span><span class="co">#&gt;     RADTV: 2</span></span>
<span><span class="co">#&gt;     FEMHEAD: 4</span></span>
<span><span class="co">#&gt;     FEMSHAFT0.5: 2</span></span>
<span><span class="co">#&gt;     DISTFEM0.5: 2</span></span>
<span><span class="co">#&gt;     DISTTIB0.5: 3</span></span>
<span><span class="co">#&gt;   other resampling parameters:</span></span>
<span><span class="co">#&gt;     ratio variables (if present): natural log of ratio</span></span>
<span><span class="co">#&gt;     matchvars = FALSE</span></span>
<span><span class="co">#&gt;     na.rm = TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Median resampled estimates for each combination of methods:</span></span>
<span><span class="co">#&gt;   methodUni methodMulti  center datastructure A. afarensis A. africanus</span></span>
<span><span class="co">#&gt; 1       MMR         GMM geomean      complete           NA           NA</span></span>
<span><span class="co">#&gt; 2       MMR         GMM geomean       missing       0.2408       0.1734</span></span>
<span><span class="co">#&gt; 3       BDI         GMM geomean      complete           NA           NA</span></span>
<span><span class="co">#&gt; 4       BDI         GMM geomean       missing       0.2374       0.1668</span></span>
<span><span class="co">#&gt;   G. gorilla H. sapiens P. troglodytes</span></span>
<span><span class="co">#&gt; 1     0.2268     0.1336         0.1027</span></span>
<span><span class="co">#&gt; 2     0.1612     0.1022         0.0807</span></span>
<span><span class="co">#&gt; 3     0.2059     0.1287         0.0998</span></span>
<span><span class="co">#&gt; 4     0.1513     0.0969         0.0766</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (one-sided; null: first sample less or equally dimorphic as second sample):</span></span>
<span><span class="co">#&gt;                               MMR:GMM:geomean:complete MMR:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus                         NA                  0.0174</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0500</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0001</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla                           NA                  0.3752</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens                           NA                  0.0103</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes                       NA                  0.0002</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0017                  0.1154</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0001                  0.0382</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0719                  0.2503</span></span>
<span><span class="co">#&gt; A. africanus - A. afarensis                         NA                  0.9826</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis                           NA                  0.9500</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis                           NA                  0.9999</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis                       NA                  1.0000</span></span>
<span><span class="co">#&gt; G. gorilla - A. africanus                           NA                  0.6248</span></span>
<span><span class="co">#&gt; H. sapiens - A. africanus                           NA                  0.9897</span></span>
<span><span class="co">#&gt; P. troglodytes - A. africanus                       NA                  0.9998</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla                         0.9983                  0.8846</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla                     0.9999                  0.9618</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens                     0.9281                  0.7497</span></span>
<span><span class="co">#&gt;                               BDI:GMM:geomean:complete BDI:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus                         NA                  0.0146</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0371</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0001</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla                           NA                  0.3424</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens                           NA                  0.0091</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes                       NA                  0.0002</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0041                  0.1271</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0003                  0.0437</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.0752                  0.2510</span></span>
<span><span class="co">#&gt; A. africanus - A. afarensis                         NA                  0.9854</span></span>
<span><span class="co">#&gt; G. gorilla - A. afarensis                           NA                  0.9629</span></span>
<span><span class="co">#&gt; H. sapiens - A. afarensis                           NA                  0.9999</span></span>
<span><span class="co">#&gt; P. troglodytes - A. afarensis                       NA                  1.0000</span></span>
<span><span class="co">#&gt; G. gorilla - A. africanus                           NA                  0.6576</span></span>
<span><span class="co">#&gt; H. sapiens - A. africanus                           NA                  0.9909</span></span>
<span><span class="co">#&gt; P. troglodytes - A. africanus                       NA                  0.9998</span></span>
<span><span class="co">#&gt; H. sapiens - G. gorilla                         0.9959                  0.8729</span></span>
<span><span class="co">#&gt; P. troglodytes - G. gorilla                     0.9997                  0.9563</span></span>
<span><span class="co">#&gt; P. troglodytes - H. sapiens                     0.9248                  0.7490</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values (two-sided):</span></span>
<span><span class="co">#&gt;                               MMR:GMM:geomean:complete MMR:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus                         NA                  0.0314</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0985</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0001</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla                           NA                  0.7543</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens                           NA                  0.0162</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes                       NA                  0.0002</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0017                  0.2305</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0001                  0.0784</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.1409                  0.4980</span></span>
<span><span class="co">#&gt;                               BDI:GMM:geomean:complete BDI:GMM:geomean:missing</span></span>
<span><span class="co">#&gt; A. afarensis - A. africanus                         NA                  0.0262</span></span>
<span><span class="co">#&gt; A. afarensis - G. gorilla                           NA                  0.0720</span></span>
<span><span class="co">#&gt; A. afarensis - H. sapiens                           NA                  0.0001</span></span>
<span><span class="co">#&gt; A. afarensis - P. troglodytes                       NA                  0.0000</span></span>
<span><span class="co">#&gt; A. africanus - G. gorilla                           NA                  0.6900</span></span>
<span><span class="co">#&gt; A. africanus - H. sapiens                           NA                  0.0140</span></span>
<span><span class="co">#&gt; A. africanus - P. troglodytes                       NA                  0.0002</span></span>
<span><span class="co">#&gt; G. gorilla - H. sapiens                         0.0044                  0.2544</span></span>
<span><span class="co">#&gt; G. gorilla - P. troglodytes                     0.0003                  0.0898</span></span>
<span><span class="co">#&gt; H. sapiens - P. troglodytes                     0.1463                  0.4995</span></span></code></pre></div>
<p>Here we can see that we have different numbers of resampled data sets
for our two fossil samples because exact resampling was used for them,
sampling each unique resampled data set exactly once. All comparative
taxa share the same number of Monte Carlo resampled data sets as
specified by the argument <code>nResamp</code>. Also, notice that the
missing data resampling structure is quite different from the single
fossil sample case: now it is “sampling variable-specific number of
individuals for each variable,” and below that is reported the sample
size used for each variable in each iteration of the resampling
procedure.</p>
<p>Aside from those differences, the type of information reported is the
same as in the single fossil sample example, and the structure of the
object is the same. We can also plot it in the same way:</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_multi</span>, groupcols<span class="op">=</span><span class="va">speciescolors</span><span class="op">)</span></span></code></pre></div>
<p>However, because both fossil samples are resampled, we now have
distributions for both of them when we plot estimates based on missing
data.</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_multi</span>, est<span class="op">=</span><span class="fl">2</span>,</span>
<span>     groupcols<span class="op">=</span><span class="va">speciescolors</span>, invert<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># invert first and second sample distributions</span></span></code></pre></div>
<p>And finally, we can again plot differences in resampled
estimates.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_2fossil_multi</span>, est<span class="op">=</span><span class="fl">2</span>, type<span class="op">=</span><span class="st">"diff"</span>,</span>
<span>     gridplot<span class="op">=</span><span class="cn">FALSE</span>, useradvance<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="dimorph_files/figure-html/unnamed-chunk-89-1.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-2.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-3.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-4.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-5.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-6.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-7.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-8.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-9.png" width="672"><img src="dimorph_files/figure-html/unnamed-chunk-89-10.png" width="672"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="useful-please-cite-it">Useful? Please cite it!<a class="anchor" aria-label="anchor" href="#useful-please-cite-it"></a>
</h2>
<p>Further information about all of these functions can be found in
their help pages. To get the full index of help pages for this package,
use <code><a href="https://rdrr.io/pkg/dimorph/man" class="external-link">help(package="dimorph")</a></code>.</p>
<p>Also, if you use this package in your work, please use the following
citations:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"dimorph"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite package 'dimorph' in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Gordon AD (2025). "Interpreting statistical significance in hominin</span></span>
<span><span class="co">#&gt;   dimorphism: Power and Type I error rates for resampling tests of</span></span>
<span><span class="co">#&gt;   univariate and missing-data multivariate size dimorphism estimation</span></span>
<span><span class="co">#&gt;   methods in the fossil record." _Journal of Human Evolution_, *199*,</span></span>
<span><span class="co">#&gt;   103630. doi:10.1016/j.jhevol.2024.103630</span></span>
<span><span class="co">#&gt;   &lt;https://doi.org/10.1016/j.jhevol.2024.103630&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Gordon AD (2025). "Sexual size dimorphism in Australopithecus:</span></span>
<span><span class="co">#&gt;   postcranial dimorphism differs significantly among Australopithecus</span></span>
<span><span class="co">#&gt;   afarensis, A. africanus, and modern humans despite low-power</span></span>
<span><span class="co">#&gt;   resampling analyses." _American Journal of Biological Anthropology_,</span></span>
<span><span class="co">#&gt;   *187*, e70093. doi:10.1002/ajpa.70093</span></span>
<span><span class="co">#&gt;   &lt;https://doi.org/10.1002/ajpa.70093&gt;.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span></span>
<span><span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span></span>
<span><span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></span></code></pre></div>
<p>And if you use any of the data sets in this package, please refer to
the help page for that data set for the proper citations.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Campisano CJ. (2007) <em>Tephrostratigraphy and hominin
paleoenvironments of the Hadar Formation, Afar Depression,
Ethiopia</em>. Ph.D. thesis. Rutgers, The State University of New
Jersey. <a href="https://www.proquest.com/docview/304805803" class="external-link">https://www.proquest.com/docview/304805803</a></p>
<p>Godfrey LR, Lyon SK, Sutherland MR. (1993) Sexual dimorphism in
large-bodied primates: The case of the subfossil lemurs. <em>American
Journal of Physical Anthropology</em>. 90:315-334. <a href="https://doi.org/10.1002/ajpa.1330900306" class="external-link">https://doi.org/10.1002/ajpa.1330900306</a></p>
<p>Gordon AD. (2025a) Interpreting statistical significance in hominin
dimorphism: Power and Type I error rates for resampling tests of
univariate and missing-data multivariate size dimorphism estimation
methods in the fossil record. <em>Journal of Human Evolution</em>.
199:103630. <a href="https://doi.org/10.1016/j.jhevol.2024.103630" class="external-link">https://doi.org/10.1016/j.jhevol.2024.103630</a></p>
<p>Gordon AD. (2025b) Sexual size dimorphism in
<em>Australopithecus</em>: postcranial dimorphism differs significantly
among <em>Australopithecus afarensis</em>, <em>A. africanus</em>, and
modern humans despite low-power resampling analyses. <em>American
Journal of Biological Anthropology</em>. 187:e70093. <a href="https://onlinelibrary.wiley.com/doi/10.1002/ajpa.70093" class="external-link">https://onlinelibrary.wiley.com/doi/10.1002/ajpa.70093</a></p>
<p>Gordon AD, Green DJ, Richmond BG. (2008) Strong postcranial size
dimorphism in <em>Australopithecus afarensis</em>: Results from two new
resampling methods for multivariate data sets with missing data.
<em>American Journal of Physical Anthropology</em>. 135:311-328. <a href="https://doi.org/10.1002/ajpa.20745" class="external-link">https://doi.org/10.1002/ajpa.20745</a></p>
<p>Gordon AD, Green DJ, Jungers WL, Richmond BG. (2020) Limb proportions
and positional behavior: revisiting the theoretical and empirical
underpinnings for locomotor reconstruction in <em>Australopithecus
africanus</em>. In Zipfel B, Richmond BG, and Ward CV, eds.: <em>Hominid
Postcranial Remains from Sterkfontein, South Africa, 1936-1995</em>.
Advances in Human Evolution Series. Oxford University Press.
pp. 321-334. <a href="https://doi.org/10.1093/oso/9780197507667.003.0017" class="external-link">Book
Chapter</a> | <a href="https://doi.org/10.1093/oso/9780197507667.005.0003" class="external-link">Appendix
III</a> | <a href="https://doi.org/10.1093/oso/9780197507667.005.0004" class="external-link">Appendix
IV</a></p>
<p>Josephson SC, Juell KE, Rogers AR. (1996) Estimating sexual
dimorphism by method-of-moments. <em>American Journal of Physical
Anthropology</em>. 100:191-206. <a href="https://doi.org/10.1002/(SICI)1096-8644(199606)100:2%3C191::AID-AJPA3%3E3.0.CO;2-0" class="external-link">https://doi.org/10.1002/(SICI)1096-8644(199606)100:2&lt;191::AID-AJPA3&gt;3.0.CO;2-0</a></p>
<p>Lee S-H. (2001) Assigned Resampling Method: A new method to estimate
size sexual dimorphism in samples of unknown sex. <em>Anthropological
Review</em>. 64:21–39. <a href="https://doi.org/10.18778/1898-6773.64.02" class="external-link">https://doi.org/10.18778/1898-6773.64.02</a></p>
<p>Reno PL, Meindl RS, McCollum MA, Lovejoy CO. (2003) Sexual dimorphism
in <em>Australopithecus afarensis</em> was similar to that of modern
humans. <em>Proceedings of the National Academy of Sciences</em>.
100:9404-9409. <a href="https://doi.org/10.1073/pnas.1133180100" class="external-link">https://doi.org/10.1073/pnas.1133180100</a></p>
<p>Sasaki T, Semaw S, Rogers MJ, Simpson SW, Beyene Y, Asfaw B, White
TD, Suwa G. (2021) Estimating sexual size dimorphism in fossil species
from posterior probability densities. <em>Proceedings of the National
Academy of Sciences</em>. 118:e2113943118. <a href="https://doi.org/10.1073/pnas.2113943118" class="external-link">https://doi.org/10.1073/pnas.2113943118</a></p>
<p>Sokal RR, Braumann CA (1980) Significance tests for coefficients of
variation and variability profiles. <em>Systematic Zoology</em>.
29:50–66. <a href="https://doi.org/10.2307/2412626" class="external-link">https://doi.org/10.2307/2412626</a></p>
<p>Smith RJ. (1999) Statistics of sexual size dimorphism. <em>Journal of
Human Evolution</em>. 36:423-458. <a href="https://doi.org/10.1006/jhev.1998.0281" class="external-link">https://doi.org/10.1006/jhev.1998.0281</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adam Gordon.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
